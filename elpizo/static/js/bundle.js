!function e(t,r,n){function i(s,a){if(!r[s]){if(!t[s]){var f="function"==typeof require&&require;if(!a&&f)return f(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=r[s]={exports:{}};t[s][0].call(l.exports,function(e){var r=t[s][1][e];return i(r?r:e)},l,l.exports,e,t,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t){function r(e,t,r,n,i,o,s){"use strict";this.resourceName=e,this.sw=t,this.sh=r,this.speedFactor=n,this.frames=i,this.offset=o,this.xrayable=s}function n(e,t,n,i,o,s){return{standing:{n:new r(e,t,n,i,o,s,!1)}}}function i(e){return{standing:{n:new r(e,32,64,0,[{sx:16,sy:0}],{sx:0,sy:32},!0),w:new r(e,32,64,0,[{sx:16,sy:64}],{sx:0,sy:32},!0),s:new r(e,32,64,0,[{sx:16,sy:128}],{sx:0,sy:32},!0),e:new r(e,32,64,0,[{sx:16,sy:192}],{sx:0,sy:32},!0)},walking:{n:new r(e,32,64,4,o(8,function(e){return{sx:16+64*(e+1),sy:512}}),{sx:0,sy:32},!0),w:new r(e,32,64,4,o(8,function(e){return{sx:16+64*(e+1),sy:576}}),{sx:0,sy:32},!0),s:new r(e,32,64,4,o(8,function(e){return{sx:16+64*(e+1),sy:640}}),{sx:0,sy:32},!0),e:new r(e,32,64,4,o(8,function(e){return{sx:16+64*(e+1),sy:704}}),{sx:0,sy:32},!0)}}}var o=e("../util/collections").repeat;t.exports={"Fixture.Tree":n("fixture/tree.png",96,96,0,[{sx:0,sy:0}],{sx:32,sy:64}),"Item.Carrot":n("item/carrot.png",32,32,0,[{sx:0,sy:0}],{sx:0,sy:0}),"Body.Male.Light":i("body/male/light.png"),"Facial.Male.BrownBeard":i("facial/male/brown_beard.png"),"Hair.Male.BrownMessy1":i("hair/male/brown_messy_1.png"),"Equipment.Male.WhiteLongsleeveShirt":i("equipment/male/white_longsleeve_shirt.png"),"Equipment.Male.TealPants":i("equipment/male/teal_pants.png"),"Equipment.Male.BrownShoes":i("equipment/male/brown_shoes.png")}},{"../util/collections":9}],2:[function(e,t){t.exports=window._exports,delete window._exports},{}],3:[function(e,t){function r(e,t){return new o(function(r){e.once(t,r)})}function n(e){"use strict";i.call(this),this.realm=null,this.me=null,this.protocol=new l(new f("ws://"+window.location.host+"/socket")),this.resources=new h,this.renderer=new s(this.resources,e),this.inputState=new u(window),c.install(this),this.renderer.on("viewportChange",function(e){this.protocol.send(new p.ViewportPacket(e))}.bind(this)),o.all([r(this.protocol.transport,"open"),r(this.resources,"bundleLoaded")]).then(function(){this.emit("ready")}.bind(this))}var i=e("events").EventEmitter,o=e("es6-promise").Promise,s=e("./graphics/renderer").Renderer,a=e("./util/net"),f=a.Transport,l=a.Protocol,h=e("./util/resources").Resources,u=e("./util/input").InputState,p=e("./game_pb2"),c=e("./handlers");for(var d in i)i.hasOwnProperty(d)&&(n[d]=i[d]);var g=null===i?null:i.prototype;n.prototype=Object.create(g),n.prototype.constructor=n,n.__superConstructor__=i,n.prototype.loadFromManifest=function(e){"use strict";var t={};Object.keys(e).forEach(function(r){var n=e[r];t[r]=h.TYPES[n]("static/assets/"+r)}),this.resources.loadBundle(t)},n.prototype.setRealm=function(e){"use strict";this.realm=e,this.renderer.setRealm(e)},n.prototype.setAvatarById=function(e){"use strict";console.log("Hello! Your player id is:",e),this.me=this.realm.getEntity(e)},n.prototype.update=function(e){"use strict";null!==this.realm&&this.realm.update(e),null!==this.me&&this.me.updateAsAvatar(e,this.inputState,this.protocol),this.renderer.render(e)},n.prototype.go=function(){"use strict";var e=(new Date).valueOf()/1e3,t=function(){var r=(new Date).valueOf()/1e3;this.update(r-e),e=r,window.requestAnimationFrame(t)}.bind(this);t()},t.exports.Game=n},{"./game_pb2":4,"./graphics/renderer":5,"./handlers":6,"./util/input":11,"./util/net":12,"./util/resources":14,"es6-promise":19,events:16}],4:[function(e,t){e("protobufjs").convertFieldsToCamelCase=!0,t.exports=e("protobufjs").newBuilder().import({"package":null,messages:[{name:"Packet",fields:[{rule:"optional",options:{},type:"Type",name:"type",id:1},{rule:"optional",options:{},type:"uint32",name:"origin",id:2},{rule:"optional",options:{},type:"bytes",name:"payload",id:3}],enums:[{name:"Type",values:[{name:"ERROR",id:0},{name:"CHAT",id:1},{name:"MOVE",id:2},{name:"AVATAR",id:3},{name:"REALM",id:4},{name:"REGION",id:5},{name:"VIEWPORT",id:6},{name:"ENTITY",id:7},{name:"STOP_MOVE",id:8},{name:"TELEPORT",id:9},{name:"STATUS",id:10}],options:{}}],messages:[],options:{}},{ref:"google.protobuf.MessageOptions",fields:[{rule:"optional",options:{},type:"Packet.Type",name:"packet_type",id:5e4}]},{name:"AbsoluteLocation",fields:[{rule:"optional",options:{},type:"uint32",name:"realm_id",id:1},{rule:"optional",options:{},type:"sint32",name:"ax",id:2},{rule:"optional",options:{},type:"sint32",name:"ay",id:3}],enums:[],messages:[],options:{}},{name:"AbsoluteRealmLocation",fields:[{rule:"optional",options:{},type:"uint32",name:"realm_id",id:1},{rule:"optional",options:{},type:"sint32",name:"arx",id:2},{rule:"optional",options:{},type:"sint32",name:"ary",id:3}],enums:[],messages:[],options:{}},{name:"Region",fields:[{rule:"optional",options:{},type:"AbsoluteRealmLocation",name:"location",id:1},{rule:"repeated",options:{},type:"uint32",name:"corners",id:2}],enums:[],messages:[],options:{}},{name:"Realm",fields:[{rule:"optional",options:{},type:"uint32",name:"id",id:1},{rule:"optional",options:{},type:"string",name:"name",id:2},{rule:"optional",options:{},type:"AbsoluteSize",name:"size",id:3}],enums:[],messages:[{name:"AbsoluteSize",fields:[{rule:"optional",options:{},type:"uint32",name:"aw",id:1},{rule:"optional",options:{},type:"uint32",name:"ah",id:2}],enums:[],messages:[],options:{}}],options:{}},{name:"Entity",fields:[{rule:"optional",options:{},type:"uint32",name:"id",id:1},{rule:"optional",options:{},type:"string",name:"type",id:3},{rule:"optional",options:{},type:"uint32",name:"direction",id:4},{rule:"optional",options:{},type:"AbsoluteLocation",name:"location",id:5}],enums:[],messages:[],options:{},extensions:[100,536870911]},{name:"Actor",fields:[{rule:"optional",options:{},type:"uint32",name:"health",id:1},{rule:"optional",options:{},type:"string",name:"gender",id:2},{rule:"optional",options:{},type:"string",name:"body",id:3},{rule:"optional",options:{},type:"string",name:"facial",id:4},{rule:"optional",options:{},type:"string",name:"hair",id:5},{rule:"optional",options:{},type:"uint32",name:"speed",id:6},{rule:"repeated",options:{},type:"Item",name:"inventory",id:7}],enums:[],messages:[{ref:"Entity",fields:[{rule:"optional",options:{},type:"Actor",name:"actor_ext",id:101}]}],options:{}},{name:"Player",fields:[{rule:"optional",options:{},type:"string",name:"name",id:1}],enums:[],messages:[{ref:"Entity",fields:[{rule:"optional",options:{},type:"Player",name:"player_ext",id:102}]}],options:{}},{name:"Fixture",fields:[{rule:"optional",options:{},type:"uint32",name:"fixture_type_id",id:1}],enums:[],messages:[{ref:"Entity",fields:[{rule:"optional",options:{},type:"Fixture",name:"fixture_ext",id:103}]}],options:{}},{name:"Item",fields:[{rule:"optional",options:{},type:"uint32",name:"id",id:1},{rule:"optional",options:{},type:"string",name:"type",id:2}],enums:[],messages:[],options:{}},{name:"Drop",fields:[{rule:"optional",options:{},type:"Item",name:"item",id:1}],enums:[],messages:[{ref:"Entity",fields:[{rule:"optional",options:{},type:"Drop",name:"drop_ext",id:104}]}],options:{}},{name:"ErrorPacket",fields:[{rule:"optional",options:{},type:"string",name:"text",id:1}],enums:[],messages:[],options:{"(packet_type)":"ERROR"}},{name:"ChatPacket",fields:[{rule:"optional",options:{},type:"string",name:"target",id:1},{rule:"optional",options:{},type:"string",name:"actor_name",id:2},{rule:"optional",options:{},type:"string",name:"text",id:3}],enums:[],messages:[],options:{"(packet_type)":"CHAT"}},{name:"MovePacket",fields:[{rule:"optional",options:{},type:"Direction",name:"direction",id:1}],enums:[{name:"Direction",values:[{name:"NORTH",id:0},{name:"WEST",id:1},{name:"SOUTH",id:2},{name:"EAST",id:3}],options:{}}],messages:[],options:{"(packet_type)":"MOVE"}},{name:"AvatarPacket",fields:[],enums:[],messages:[],options:{"(packet_type)":"AVATAR"}},{name:"RealmPacket",fields:[{rule:"optional",options:{},type:"Realm",name:"realm",id:1}],enums:[],messages:[],options:{"(packet_type)":"REALM"}},{name:"RegionPacket",fields:[{rule:"optional",options:{},type:"Region",name:"region",id:1}],enums:[],messages:[],options:{"(packet_type)":"REGION"}},{name:"ViewportPacket",fields:[{rule:"optional",options:{},type:"sint32",name:"a_left",id:1},{rule:"optional",options:{},type:"sint32",name:"a_top",id:2},{rule:"optional",options:{},type:"sint32",name:"a_right",id:3},{rule:"optional",options:{},type:"sint32",name:"a_bottom",id:4}],enums:[],messages:[],options:{"(packet_type)":"VIEWPORT"}},{name:"EntityPacket",fields:[{rule:"optional",options:{},type:"Entity",name:"entity",id:1}],enums:[],messages:[],options:{"(packet_type)":"ENTITY"}},{name:"StopMovePacket",fields:[],enums:[],messages:[],options:{"(packet_type)":"STOP_MOVE"}},{name:"TeleportPacket",fields:[{rule:"optional",options:{},type:"AbsoluteLocation",name:"location",id:1},{rule:"optional",options:{},type:"uint32",name:"direction",id:2}],enums:[],messages:[],options:{"(packet_type)":"TELEPORT"}},{name:"StatusPacket",fields:[{rule:"optional",options:{},type:"bool",name:"online",id:1}],enums:[],messages:[],options:{"(packet_type)":"STATUS"}}],enums:[],imports:[],options:{},services:[]}).build()},{protobufjs:30}],5:[function(e,t){function r(e,t){"use strict";this.def=e,this.speed=t,this.frameIndex=0}function n(e,t){"use strict";i.call(this),this.el=document.createElement("div"),this.el.classList.add("renderer"),this.el.style.position="relative",this.el.onclick=this.handleOnClick.bind(this),t.appendChild(this.el),this.terrainCanvas=this.createCanvas(),this.terrainCanvas.style.zIndex=0,this.el.appendChild(this.terrainCanvas),this.entityCanvas=this.createCanvas(),this.entityCanvas.style.zIndex=1,this.el.appendChild(this.entityCanvas),this.xrayCanvas=this.createCanvas(),this.xrayCanvas.style.zIndex=2,this.xrayCanvas.style.opacity=.25,this.el.appendChild(this.xrayCanvas),this.aTopLeft={ax:0,ay:0},this.resources=e,this.realm=null,this.regionTerrainCache={},this.entitySprites={}}var i=e("events").EventEmitter,o=e("../models").Directions,s=e("../util/collections").repeat,a=e("../util/objects"),f=a.hasOwnProp,l=a.extend,h=e("../util/coords"),u=e("../assets/sprites");r.prototype.render=function(e,t,r){"use strict";this.frameIndex+=this.speed*this.def.speedFactor*t;var n=this.def.frames[Math.floor(this.frameIndex)%this.def.frames.length];r.drawImage(e.get("sprites/"+this.def.resourceName),n.sx,n.sy,this.def.sw,this.def.sh,0,0,this.def.sw,this.def.sh)};for(var p in i)i.hasOwnProperty(p)&&(n[p]=i[p]);var c=null===i?null:i.prototype;n.prototype=Object.create(c),n.prototype.constructor=n,n.__superConstructor__=i,n.prototype.handleOnClick=function(e){"use strict";var t=e.clientX-this.sBounds.left,r=e.clientY-this.sBounds.top,n=this.screenToAbsoluteCoords({sx:t,sy:r});this.emit("click",{ax:Math.floor(n.ax+this.aTopLeft.ax),ay:Math.floor(n.ay+this.aTopLeft.ay)})},n.prototype.prepareContext=function(e){"use strict";e.imageSmoothingEnabled=!1,e.webkitImageSmoothingEnabled=!1,e.mozImageSmoothingEnabled=!1},n.prototype.createCanvas=function(){"use strict";var e=document.createElement("canvas");return l(e.style,{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"}),e},n.prototype.absoluteToScreenCoords=function(e){"use strict";return{sx:e.ax*n.TILE_SIZE,sy:e.ay*n.TILE_SIZE}},n.prototype.screenToAbsoluteCoords=function(e){"use strict";return{ax:e.sx/n.TILE_SIZE,ay:e.sy/n.TILE_SIZE}},n.prototype.setScreenViewportSize=function(e,t){"use strict";this.el.style.width=e+"px",this.el.style.height=t+"px",this.sBounds=this.el.getBoundingClientRect(),this.terrainCanvas.width=e,this.terrainCanvas.height=t,this.entityCanvas.width=e,this.entityCanvas.height=t,this.xrayCanvas.width=e,this.xrayCanvas.height=t,this.emit("viewportChange",this.getAbsoluteWorldBounds())},n.prototype.getScreenViewportSize=function(){"use strict";return{sw:this.sBounds.width,sh:this.sBounds.height}},n.prototype.getAbsoluteWorldBounds=function(){"use strict";var e=this.getScreenViewportSize(),t=this.screenToAbsoluteCoords({sx:e.sw,sy:e.sh});return{aLeft:this.aTopLeft.ax,aTop:this.aTopLeft.ay,aRight:this.aTopLeft.ax+t.ax,aBottom:this.aTopLeft.ay+t.ay}},n.prototype.getRegionWorldBounds=function(){"use strict";var e=this.getAbsoluteWorldBounds(),t=h.absoluteToContainingRegion({ax:e.aLeft,ay:e.aTop}),r=h.absoluteToContainingRegion({ax:e.aRight,ay:e.aBottom});return{arLeft:Math.floor(t.arx),arTop:Math.floor(t.ary),arRight:Math.floor(r.arx)+1,arBottom:Math.floor(r.ary)+1}},n.prototype.setRealm=function(e){"use strict";this.realm=e,this.entitySprites={},this.regionTerrainCache={}},n.prototype.render=function(e){"use strict";null!==this.realm&&(this.renderTerrain(this.realm),this.renderEntities(this.realm,e))},n.prototype.renderTerrain=function(e){"use strict";var t=(this.getScreenViewportSize(),this.absoluteToScreenCoords({ax:h.REGION_SIZE,ay:h.REGION_SIZE}),this.terrainCanvas.getContext("2d"));t.clearRect(0,0,this.terrainCanvas.width,this.terrainCanvas.height);for(var r=this.absoluteToScreenCoords({ax:-this.aTopLeft.ax,ay:-this.aTopLeft.ay}),n=this.getRegionWorldBounds(),i=n.arTop;i<n.arBottom;++i)for(var o=n.arLeft;o<n.arRight;++o){var s=this.absoluteToScreenCoords(h.regionToAbsolute({arx:o,ary:i})),a=Math.round(r.sx+s.sx),l=Math.round(r.sy+s.sy),u=[o,i].join(","),p=e.getRegion({arx:o,ary:i});if(null!==p){f.call(this.regionTerrainCache,u)||(this.regionTerrainCache[u]=this.renderRegionTerrainAsBuffer(p));var c=this.regionTerrainCache[u];t.drawImage(c,a,l)}}},n.prototype.renderEntities=function(e,t){"use strict";var r=this.entityCanvas.getContext("2d");this.prepareContext(r),r.clearRect(0,0,this.entityCanvas.width,this.entityCanvas.height);var n=this.xrayCanvas.getContext("2d");this.prepareContext(n),n.clearRect(0,0,this.xrayCanvas.width,this.xrayCanvas.height);var i=this.getAbsoluteWorldBounds(),o=(Math.ceil(i.aBottom-i.aTop),e.getAllEntities().filter(function(e){return e.location.ay>=i.aTop&&e.location.ay<i.aBottom}).sort(function(e,t){return"Drop"===e.type?-1:"Drop"===t.type?1:e.location.ay-t.location.ay}));o.forEach(function(e){this.renderEntity(e,r,t,!1)}.bind(this)),o.forEach(function(e){this.renderEntity(e,n,0,!0)}.bind(this))},n.prototype.renderRegionTerrainAsBuffer=function(e){"use strict";var t=document.createElement("canvas"),r=this.absoluteToScreenCoords({ax:h.REGION_SIZE,ay:h.REGION_SIZE});t.width=r.sx,t.height=r.sy;var i=t.getContext("2d");return this.prepareContext(i),e.terrain.forEach(function(e,t){var r=t%h.REGION_SIZE,o=Math.floor(t/h.REGION_SIZE),s=e.map(function(e){return e.name}).join(",");f.call(n.TILE_TEXTURE_MAPPINGS,s)&&(e=[{name:s,mask:e[e.length-1].mask}]),e.forEach(function(e){var t=n.TILE_TEXTURE_MAPPINGS[e.name];n.TILE_TEXTURE_COORDS[e.mask].forEach(function(e,s){var a=e%6,f=Math.floor(e/6),l=[0,1,0,1][s],h=[0,0,1,1][s],u=this.absoluteToScreenCoords({ax:r+l/2,ay:o+h/2});i.drawImage(this.resources.get("tiles/"+t),a*n.TILE_SIZE/2,f*n.TILE_SIZE/2,n.TILE_SIZE/2,n.TILE_SIZE/2,u.sx,u.sy,n.TILE_SIZE/2,n.TILE_SIZE/2)}.bind(this))}.bind(this))}.bind(this)),t},n.prototype.getSpriteDirection=function(e){"use strict";switch(e){case o.N:return"n";case o.W:return"w";case o.S:return"s";case o.E:return"e"}},n.prototype.getSpriteState=function(e){"use strict";return e.moving?"walking":"standing"},n.prototype.renderEntity=function(e,t,i,o){"use strict";var a=this.getSpriteState(e),l=this.getSpriteDirection(e.direction),h=n.SPRITES[e.type](e).map(function(e){return u[e][a][l]});f.call(this.entitySprites,e.id)&&this.entitySprites[e.id].length==h.length||(this.entitySprites[e.id]=s(h.length,function(){return new r(null,e.speed||0)})),h.forEach(function(t,r){this.entitySprites[e.id][r].def=t}.bind(this));var p=this.absoluteToScreenCoords({ax:e.location.ax-this.aTopLeft.ax,ay:e.location.ay-this.aTopLeft.ay});t.save(),t.translate(p.sx,p.sy),this.entitySprites[e.id].forEach(function(e){t.save(),t.translate(-e.def.offset.sx,-e.def.offset.sy),(!o||e.def.xrayable)&&e.render(this.resources,i,t),t.restore()}.bind(this)),t.restore()},t.exports.Renderer=n,n.SPRITES={Actor:function(e){var t=[["Body",e.gender,e.body].join(".")];return e.facial&&t.push(["Facial",e.gender,e.facial].join(".")),e.hair&&t.push(["Hair",e.gender,e.hair].join(".")),[].push.apply(t,e.equipment.map(function(t){return["Equipment",e.gender,t.type].join(".")})),t},Fixture:function(e){return[["Fixture",e.fixtureType.name].join(".")]},Drop:function(e){return[["Item",e.item.type].join(".")]}},n.SPRITES.Player=n.SPRITES.Actor,n.TILE_SIZE=32,n.TILE_TEXTURE_MAPPINGS={grassland:"grass.png",ocean:"water.png",river:"water.png",lakeshore:"water.png","grassland,lakeshore":"water-grass.png",lake:"water.png",beach:"beach.png","ocean,beach":"beach.png",subtropical_desert:"sand.png"},n.TILE_TEXTURE_COORDS={1:[28,29,34,35],2:[24,25,30,31],3:[26,27,32,32],4:[48,49,54,55],5:[16,3,22,9],6:[36,37,42,43],7:[16,17,22,23],8:[52,53,58,59],9:[40,41,46,47],10:[4,15,10,21],11:[14,15,20,21],12:[50,51,56,57],13:[2,3,8,9],14:[4,5,10,11],15:[38,39,44,45]}},{"../assets/sprites":1,"../models":8,"../util/collections":9,"../util/coords":10,"../util/objects":13,events:16}],6:[function(e,t){function r(e){var t=e.protocol;t.on(a.Type.REALM,function(t,r){e.setRealm(new i(r.realm))}),t.on(a.Type.REGION,function(t,r){return r.region.location.realmId!==e.realm.id?void console.warn("Got invalid region realm ID ("+r.region.realmId+") for current realm ("+e.realm.id+"), discarding."):void e.realm.addRegion(new o(r.region))}),t.on(a.Type.ENTITY,function(t,r){return r.entity.location.realmId!==e.realm.id?void console.warn("Got invalid entity realm ID ("+r.entity.location.realmId+") for current realm ("+e.realm.id+"), discarding."):void e.realm.addEntity(new s.TYPES[r.entity.type](r.entity))}),t.on(a.Type.AVATAR,function(t){e.setAvatarById(t)}),t.on(a.Type.MOVE,function(t,r){e.realm.getEntity(t).moveInDirection(r.direction)}),t.on(a.Type.STOP_MOVE,function(t){e.realm.getEntity(t).moving=!1}),t.on(a.Type.TELEPORT,function(t,r){var n=e.realm.getEntity(t);return r.location.realmId!==e.realm.id?void console.warn("Got invalid teleport realm ID ("+r.location.realmId+") for current realm ("+e.realm.id+"), discarding."):(n.moving=!1,n.remainder=0,n.location={ax:r.location.ax,ay:r.location.ay},void(n.direction=r.direction))})}var n=(e("./constants/exports"),e("./models")),i=n.Realm,o=n.Region,s=n.Entity,a=(n.Directions,e("./game_pb2").Packet);t.exports.install=r},{"./constants/exports":2,"./game_pb2":4,"./models":8}],7:[function(e){var t=e("./game").Game,r=(e("./util/resources").loadImage,new t(document.body));r.loadFromManifest(window._manifest),r.on("ready",function(){r.renderer.setScreenViewportSize(1024,768),r.go()})},{"./game":3,"./util/resources":14}],8:[function(e,t,r){function n(e,t){return 0>t?w.N:0>e?w.W:t>0?w.S:e>0?w.E:-1}function i(e){switch(e){case w.N:return{ax:0,ay:-1};case w.W:return{ax:-1,ay:0};case w.S:return{ax:0,ay:1};case w.E:return{ax:1,ay:0}}}function o(e){"use strict";this.id=e.id,this.name=e.name,this.size={aw:e.size.aw,ah:e.size.ah},this.regions={},this.entities={}}function s(e){"use strict";this.location={arx:e.location.arx,ary:e.location.ary},this.corners=e.corners.map(function(e){return r.terrain[e]}),this.terrain=this.computeTerrain()}function a(e){"use strict";c.call(this),this.id=e.id,this.type=e.type,this.location={ax:e.location.ax,ay:e.location.ay},this.direction=e.direction}function f(e){"use strict";a.call(this,e),e=e.actorExt,this.equipment=[],this.gender=e.gender,this.body=e.body,this.hair=e.hair,this.facial=e.facial,this.speed=e.speed,this.moving=!1,this.remainder=0}function l(e){"use strict";f.call(this,e),e=e.playerExt,this.name=e.name}function h(e){"use strict";a.call(this,e),e=e.fixtureExt,this.fixtureType=r.fixtureTypes[e.fixtureTypeId],this.aLeft=e.aLeft,this.aTop=e.aTop,this.aRight=e.aRight,this.aBottom=e.aBottom}function u(e){"use strict";this.id=e.id,this.type=e.type}function p(e){"use strict";a.call(this,e),e=e.dropExt,this.item=new u(e.item)}var c=e("events").EventEmitter,d=e("./util/collections"),g=d.nubBy,y=(d.repeat,e("./util/objects").hasOwnProp),m=e("./game_pb2"),r=e("./constants/exports"),E=e("./util/coords"),w=t.exports.Directions={N:0,W:1,S:2,E:3};t.exports.getDirectionConstant=n,t.exports.getDirectionVector=i,o.prototype.addRegion=function(e){"use strict";this.regions[e.getKey()]=e},o.prototype.removeRegion=function(e){"use strict";delete this.regions[e.getKey()]},o.prototype.getRegion=function(e){"use strict";var t=[e.arx,e.ary].join(",");return y.call(this.regions,t)?this.regions[t]:null},o.prototype.getClosestRegion=function(e){"use strict";return this.getRegion(E.absoluteToContainingRegion(e))},o.prototype.isPassable=function(e,t){"use strict";var r=this.getClosestRegion(e);return null!==r&&r.isPassable(E.absoluteToRelative(e),t)?this.getAllEntities().filter(function(e){return"Fixture"==e.type}).some(function(t){return e.ax>=t.location.ax+t.fixtureType.size.aLeft&&e.ax<t.location.ax+t.fixtureType.size.aRight&&e.ay>=t.location.ay+t.fixtureType.size.aTop&&e.ay<t.location.ay+t.fixtureType.size.aBottom})?!1:!0:!1},o.prototype.addEntity=function(e){"use strict";e.realm=this,this.entities[e.id]=e},o.prototype.removeEntity=function(e){"use strict";delete this.entities[e.id],delete e.realm},o.prototype.getEntity=function(e){"use strict";return y.call(this.entities,e)?this.entities[e]:null},o.prototype.getAllEntities=function(){"use strict";return Object.keys(this.entities).map(function(e){return this.entities[e]}.bind(this))},o.prototype.update=function(e){"use strict";this.getAllEntities().forEach(function(t){t.update(e)})},t.exports.Realm=o,s.prototype.getKey=function(){"use strict";return[this.location.arx,this.location.ary].join(",")},s.prototype.computeTerrain=function(){"use strict";for(var e=new Array(E.REGION_SIZE*E.REGION_SIZE),t=0;t<E.REGION_SIZE;++t)for(var r=0;r<E.REGION_SIZE;++r){var n=this.corners[(t+0)*(E.REGION_SIZE+1)+(r+0)],i=this.corners[(t+0)*(E.REGION_SIZE+1)+(r+1)],o=this.corners[(t+1)*(E.REGION_SIZE+1)+(r+0)],a=this.corners[(t+1)*(E.REGION_SIZE+1)+(r+1)],f=g([n,i,o,a].filter(function(e){return null!==e}).sort(function(e,t){return s.TERRAIN_PREDECENCES.indexOf(e.name)-s.TERRAIN_PREDECENCES.indexOf(t.name)}),function(e){return e.name});e[t*E.REGION_SIZE+r]=f.map(function(e,t){var r=f.slice(t).concat(s.TERRAIN_BLENDS[e.name]||[]);return{name:e.name,mask:(-1!==r.indexOf(n))<<3|(-1!==r.indexOf(i))<<2|(-1!==r.indexOf(a))<<1|(-1!==r.indexOf(o))<<0,passable:e.passable}})}return e},s.prototype.isPassable=function(e,t){"use strict";var r=this.corners[(e.ry+0)*(E.REGION_SIZE+1)+(e.rx+0)],n=this.corners[(e.ry+0)*(E.REGION_SIZE+1)+(e.rx+1)],i=this.corners[(e.ry+1)*(E.REGION_SIZE+1)+(e.rx+0)],o=this.corners[(e.ry+1)*(E.REGION_SIZE+1)+(e.rx+1)],s=(null!==r?r.passable>>t&1:!1)<<3|(null!==n?n.passable>>t&1:!1)<<2|(null!==o?o.passable>>t&1:!1)<<1|(null!==i?i.passable>>t&1:!1)<<0;return{0:!1,1:!1,2:!1,3:!0,4:!1,5:!0,6:!1,7:!0,8:!1,9:!1,10:!0,11:!0,12:!1,13:!1,14:!1,15:!0}[s]},t.exports.Region=s,s.TERRAIN_BLENDS={},s.TERRAIN_PREDECENCES=["ocean","beach","subtropical_desert","tropical_seasonal_forest","grassland","tropical_rain_forest","lake","river","lakeshore"];for(var v in c)c.hasOwnProperty(v)&&(a[v]=c[v]);var b=null===c?null:c.prototype;a.prototype=Object.create(b),a.prototype.constructor=a,a.__superConstructor__=c,a.prototype.update=function(){"use strict"},t.exports.Entity=a;for(var I in a)a.hasOwnProperty(I)&&(f[I]=a[I]);var T=null===a?null:a.prototype;f.prototype=Object.create(T),f.prototype.constructor=f,f.__superConstructor__=a,f.prototype.moveInDirection=function(e){"use strict";var t=this.direction,r=i(this.direction);return this.location.ax=Math.round(this.location.ax+r.ax*this.remainder),this.location.ay=Math.round(this.location.ay+r.ay*this.remainder),this.direction=e,r=i(this.direction),this.realm.isPassable({ax:Math.round(this.location.ax+r.ax),ay:Math.round(this.location.ay+r.ay)},e)?(this.remainder=1,this.moving=!0):(this.remainder=0,this.moving=t!==this.direction),this.moving&&this.emit("moveStart",this.location),this.moving},f.prototype.update=function(e){"use strict";if(T.update.call(this,e),this.remainder>0){var t=i(this.direction),r=Math.min(this.speed*e,this.remainder);this.location.ax+=t.ax*r,this.location.ay+=t.ay*r,this.emit("moveStep",{aDistance:r}),this.remainder-=r,this.remainder<=0&&(this.location.ax=Math.round(this.location.ax),this.location.ay=Math.round(this.location.ay),this.remainder=0,this.emit("moveEnd",this.location))}},f.prototype.updateAsAvatar=function(e,t,r){"use strict";if(0===this.remainder){var n=t.isPressed(37)?w.W:t.isPressed(38)?w.N:t.isPressed(39)?w.E:t.isPressed(40)?w.S:null;if(null!==n){var i=this.moving;this.moveInDirection(n)?r.send(new m.MovePacket({direction:n})):i&&(this.moving=!1,r.send(new m.StopMovePacket))}else this.moving&&(this.moving=!1,r.send(new m.StopMovePacket))}},t.exports.Actor=f;for(var x in f)f.hasOwnProperty(x)&&(l[x]=f[x]);var S=null===f?null:f.prototype;l.prototype=Object.create(S),l.prototype.constructor=l,l.__superConstructor__=f,t.exports.Player=l;for(I in a)a.hasOwnProperty(I)&&(h[I]=a[I]);h.prototype=Object.create(T),h.prototype.constructor=h,h.__superConstructor__=a,t.exports.Fixture=h,t.exports.Item=u;for(I in a)a.hasOwnProperty(I)&&(p[I]=a[I]);p.prototype=Object.create(T),p.prototype.constructor=p,p.__superConstructor__=a,t.exports.Drop=p,a.TYPES={Actor:f,Player:l,Fixture:h,Drop:p}},{"./constants/exports":2,"./game_pb2":4,"./util/collections":9,"./util/coords":10,"./util/objects":13,events:16}],9:[function(e,t){function r(e,t){for(var r=new Array(e),n=0;e>n;++n)r[n]=t(n);return r}function n(e,t){var r={},n=[];return e.forEach(function(e){var i=t(e);r[i]||(n.push(e),r[i]=!0)}),n}function i(e,t,n){var i=r(e,function(){return[]});return n.forEach(function(e){i[t(e)].push(e)}),[].concat.apply([],i)}t.exports.repeat=r,t.exports.nubBy=n,t.exports.countingSort=i},{}],10:[function(e,t){function r(e){return{arx:Math.floor(e.ax/o),ary:Math.floor(e.ay/o)}}function n(e){return{ax:e.arx*o,ay:e.ary*o}}function i(e){return{rx:e.ax%o,ry:e.ay%o}}var o=t.exports.REGION_SIZE=16;t.exports.absoluteToContainingRegion=r,t.exports.regionToAbsolute=n,t.exports.absoluteToRelative=i},{}],11:[function(e,t){function r(){"use strict";this.keysDown={},window.onkeydown=function(e){this.keysDown[e.which]=!0}.bind(this),window.onkeyup=function(e){delete this.keysDown[e.which]}.bind(this)}r.prototype.isPressed=function(e){"use strict";return!!this.keysDown[e]},t.exports.InputState=r},{}],12:[function(e,t){function r(e){"use strict";s.call(this),this.host=e,this.connect(),this.opened=!1}function n(e){"use strict";s.call(this),this.transport=e,this.transport.opened&&setTimeout(this.emit.bind(this,"open"),0),this.transport.on("message",function(e){var t=l[e.type].decode(e.payload);this.emit(e.type,e.origin,t)}.bind(this))}var i=e("../game_pb2"),o=e("./objects").hasOwnProp,s=e("events").EventEmitter;for(var a in s)s.hasOwnProperty(a)&&(r[a]=s[a]);var f=null===s?null:s.prototype;r.prototype=Object.create(f),r.prototype.constructor=r,r.__superConstructor__=s,r.prototype.connect=function(){"use strict";this.socket=new WebSocket(this.host),this.socket.binaryType="arraybuffer",this.socket.onopen=function(){this.opened=!0,this.emit("open")}.bind(this),this.socket.onclose=function(){console.warn("Socket died."),this.emit("close")}.bind(this),this.socket.onmessage=function(e){this.emit("message",i.Packet.decode(e.data))}.bind(this)},r.prototype.send=function(e){"use strict";this.socket.send(e.encode().buffer)},r.prototype.close=function(){"use strict";this.socket.close()},t.exports.Transport=r;var l={};Object.keys(i).forEach(function(e){var t=i[e];if(o.call(t.$options,"(packet_type)")){var r=i.Packet.Type[t.$options["(packet_type)"]];l[r]=t}});for(a in s)s.hasOwnProperty(a)&&(n[a]=s[a]);n.prototype=Object.create(f),n.prototype.constructor=n,n.__superConstructor__=s,n.prototype.send=function(e){"use strict";this.transport.send(new i.Packet({type:e.$type.options["(packet_type)"],payload:e.encode()}))},t.exports.Protocol=n},{"../game_pb2":4,"./objects":13,events:16}],13:[function(e,t){function r(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);return e}var n=t.exports.hasOwnProp=Object.prototype.hasOwnProperty;t.exports.extend=r;t.exports.nextMonotonicId=function(){var e=0;return function(){var t=e;return++e,"monotonic-id-"+t}}()},{}],14:[function(e,t){function r(e){return new o(function(t,r){var n=new Image;return n.src=e,n.onload=function(){return t(n)},n.onerror=function(e){return r(new Error(e))},n})}function n(){"use strict";i.call(this),this.$Resources_resources={}}var i=e("events").EventEmitter,o=e("es6-promise").Promise;t.exports.loadImage=r;for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s]);var a=null===i?null:i.prototype;n.prototype=Object.create(a),n.prototype.constructor=n,n.__superConstructor__=i,n.prototype.load=function(e,t){"use strict";return t.then(function(t){return this.$Resources_resources[e]=t,this.emit("resourceLoaded",{name:e,resource:t}),t}.bind(this))},n.prototype.loadBundle=function(e){"use strict";var t=Object.keys(e);return o.all(t.map(function(t){return this.load(t,e[t])}.bind(this))).then(function(){var e=t.map(function(e){return this.$Resources_resources[e]}.bind(this));return this.emit("bundleLoaded",e),e}.bind(this))},n.prototype.get=function(e){"use strict";return this.$Resources_resources[e]||null},t.exports.Resources=n,n.TYPES={image:r}},{"es6-promise":19,events:16}],15:[function(){},{}],16:[function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function i(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!i(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,i,a,f,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length))throw t=arguments[1],t instanceof Error?t:TypeError('Uncaught, unspecified "error" event.');if(r=this._events[e],s(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,a=new Array(i-1),f=1;i>f;f++)a[f-1]=arguments[f];r.apply(this,a)}else if(o(r)){for(i=arguments.length,a=new Array(i-1),f=1;i>f;f++)a[f-1]=arguments[f];for(l=r.slice(),i=l.length,f=0;i>f;f++)l[f].apply(this,a)}return!0},r.prototype.addListener=function(e,t){var i;if(!n(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned){var i;i=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function r(){this.removeListener(e,r),i||(i=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var i=!1;return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var r,i,s,a;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;
if(r=this._events[e],s=r.length,i=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(r)){for(a=s;a-->0;)if(r[a]===t||r[a].listener&&r[a].listener===t){i=a;break}if(0>i)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],n(r))this.removeListener(e,r);else for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.listenerCount=function(e,t){var r;return r=e._events&&e._events[t]?n(e._events[t])?1:e._events[t].length:0}},{}],17:[function(e,t,r){(function(e){function t(e,t){for(var r=0,n=e.length-1;n>=0;n--){var i=e[n];"."===i?e.splice(n,1):".."===i?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function n(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(e){return i.exec(e).slice(1)};r.resolve=function(){for(var r="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var s=o>=0?arguments[o]:e.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(r=s+"/"+r,i="/"===s.charAt(0))}return r=t(n(r.split("/"),function(e){return!!e}),!i).join("/"),(i?"/":"")+r||"."},r.normalize=function(e){var i=r.isAbsolute(e),o="/"===s(e,-1);return e=t(n(e.split("/"),function(e){return!!e}),!i).join("/"),e||i||(e="."),e&&o&&(e+="/"),(i?"/":"")+e},r.isAbsolute=function(e){return"/"===e.charAt(0)},r.join=function(){var e=Array.prototype.slice.call(arguments,0);return r.normalize(n(e,function(e){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},r.relative=function(e,t){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=r.resolve(e).substr(1),t=r.resolve(t).substr(1);for(var i=n(e.split("/")),o=n(t.split("/")),s=Math.min(i.length,o.length),a=s,f=0;s>f;f++)if(i[f]!==o[f]){a=f;break}for(var l=[],f=a;f<i.length;f++)l.push("..");return l=l.concat(o.slice(a)),l.join("/")},r.sep="/",r.delimiter=":",r.dirname=function(e){var t=o(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},r.basename=function(e,t){var r=o(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},r.extname=function(e){return o(e)[3]};var s="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return 0>t&&(t=e.length+t),e.substr(t,r)}}).call(this,e("FWaASH"))},{FWaASH:18}],18:[function(e,t){function r(){}var n=t.exports={};n.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var r=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),r.length>0)){var n=r.shift();n()}},!0),function(e){r.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.on=r,n.addListener=r,n.once=r,n.off=r,n.removeListener=r,n.removeAllListeners=r,n.emit=r,n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")}},{}],19:[function(e,t,r){"use strict";var n=e("./promise/promise").Promise,i=e("./promise/polyfill").polyfill;r.Promise=n,r.polyfill=i},{"./promise/polyfill":23,"./promise/promise":24}],20:[function(e,t,r){"use strict";function n(e){var t=this;if(!i(e))throw new TypeError("You must pass an array to all.");return new t(function(t,r){function n(e){return function(t){i(e,t)}}function i(e,r){a[e]=r,0===--f&&t(a)}var s,a=[],f=e.length;0===f&&t([]);for(var l=0;l<e.length;l++)s=e[l],s&&o(s.then)?s.then(n(l),r):i(l,s)})}var i=e("./utils").isArray,o=e("./utils").isFunction;r.all=n},{"./utils":28}],21:[function(e,t,r){(function(e,t){"use strict";function n(){return function(){e.nextTick(s)}}function i(){var e=0,t=new h(s),r=document.createTextNode("");return t.observe(r,{characterData:!0}),function(){r.data=e=++e%2}}function o(){return function(){u.setTimeout(s,1)}}function s(){for(var e=0;e<p.length;e++){var t=p[e],r=t[0],n=t[1];r(n)}p=[]}function a(e,t){var r=p.push([e,t]);1===r&&f()}var f,l="undefined"!=typeof window?window:{},h=l.MutationObserver||l.WebKitMutationObserver,u="undefined"!=typeof t?t:void 0===this?window:this,p=[];f="undefined"!=typeof e&&"[object process]"==={}.toString.call(e)?n():h?i():o(),r.asap=a}).call(this,e("FWaASH"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{FWaASH:18}],22:[function(e,t,r){"use strict";function n(e,t){return 2!==arguments.length?i[e]:void(i[e]=t)}var i={instrument:!1};r.config=i,r.configure=n},{}],23:[function(e,t,r){(function(t){"use strict";function n(){var e;e="undefined"!=typeof t?t:"undefined"!=typeof window&&window.document?window:self;var r="Promise"in e&&"resolve"in e.Promise&&"reject"in e.Promise&&"all"in e.Promise&&"race"in e.Promise&&function(){var t;return new e.Promise(function(e){t=e}),o(t)}();r||(e.Promise=i)}var i=e("./promise").Promise,o=e("./utils").isFunction;r.polyfill=n}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./promise":24,"./utils":28}],24:[function(e,t,r){"use strict";function n(e){if(!y(e))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof n))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],i(e,this)}function i(e,t){function r(e){l(t,e)}function n(e){u(t,e)}try{e(r,n)}catch(i){n(i)}}function o(e,t,r,n){var i,o,s,a,h=y(r);if(h)try{i=r(n),s=!0}catch(p){a=!0,o=p}else i=n,s=!0;f(t,i)||(h&&s?l(t,i):a?u(t,o):e===x?l(t,i):e===S&&u(t,i))}function s(e,t,r,n){var i=e._subscribers,o=i.length;i[o]=t,i[o+x]=r,i[o+S]=n}function a(e,t){for(var r,n,i=e._subscribers,s=e._detail,a=0;a<i.length;a+=3)r=i[a],n=i[a+t],o(t,r,n,s);e._subscribers=null}function f(e,t){var r,n=null;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(g(t)&&(n=t.then,y(n)))return n.call(t,function(n){return r?!0:(r=!0,void(t!==n?l(e,n):h(e,n)))},function(t){return r?!0:(r=!0,void u(e,t))}),!0}catch(i){return r?!0:(u(e,i),!0)}return!1}function l(e,t){e===t?h(e,t):f(e,t)||h(e,t)}function h(e,t){e._state===I&&(e._state=T,e._detail=t,d.async(p,e))}function u(e,t){e._state===I&&(e._state=T,e._detail=t,d.async(c,e))}function p(e){a(e,e._state=x)}function c(e){a(e,e._state=S)}var d=e("./config").config,g=(e("./config").configure,e("./utils").objectOrFunction),y=e("./utils").isFunction,m=(e("./utils").now,e("./all").all),E=e("./race").race,w=e("./resolve").resolve,v=e("./reject").reject,b=e("./asap").asap;d.async=b;var I=void 0,T=0,x=1,S=2;n.prototype={constructor:n,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(e,t){var r=this,n=new this.constructor(function(){});if(this._state){var i=arguments;d.async(function(){o(r._state,n,i[r._state-1],r._detail)})}else s(this,n,e,t);return n},"catch":function(e){return this.then(null,e)}},n.all=m,n.race=E,n.resolve=w,n.reject=v,r.Promise=n},{"./all":20,"./asap":21,"./config":22,"./race":25,"./reject":26,"./resolve":27,"./utils":28}],25:[function(e,t,r){"use strict";function n(e){var t=this;if(!i(e))throw new TypeError("You must pass an array to race.");return new t(function(t,r){for(var n,i=0;i<e.length;i++)n=e[i],n&&"function"==typeof n.then?n.then(t,r):t(n)})}var i=e("./utils").isArray;r.race=n},{"./utils":28}],26:[function(e,t,r){"use strict";function n(e){var t=this;return new t(function(t,r){r(e)})}r.reject=n},{}],27:[function(e,t,r){"use strict";function n(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=this;return new t(function(t){t(e)})}r.resolve=n},{}],28:[function(e,t,r){"use strict";function n(e){return i(e)||"object"==typeof e&&null!==e}function i(e){return"function"==typeof e}function o(e){return"[object Array]"===Object.prototype.toString.call(e)}var s=Date.now||function(){return(new Date).getTime()};r.objectOrFunction=n,r.isFunction=i,r.isArray=o,r.now=s},{}],29:[function(e,t){!function(r){"use strict";function n(t){var r={};return r.VERSION="3.2.3",r.WIRE_TYPES={},r.WIRE_TYPES.VARINT=0,r.WIRE_TYPES.BITS64=1,r.WIRE_TYPES.LDELIM=2,r.WIRE_TYPES.STARTGROUP=3,r.WIRE_TYPES.ENDGROUP=4,r.WIRE_TYPES.BITS32=5,r.PACKABLE_WIRE_TYPES=[r.WIRE_TYPES.VARINT,r.WIRE_TYPES.BITS64,r.WIRE_TYPES.BITS32],r.TYPES={int32:{name:"int32",wireType:r.WIRE_TYPES.VARINT},uint32:{name:"uint32",wireType:r.WIRE_TYPES.VARINT},sint32:{name:"sint32",wireType:r.WIRE_TYPES.VARINT},int64:{name:"int64",wireType:r.WIRE_TYPES.VARINT},uint64:{name:"uint64",wireType:r.WIRE_TYPES.VARINT},sint64:{name:"sint64",wireType:r.WIRE_TYPES.VARINT},bool:{name:"bool",wireType:r.WIRE_TYPES.VARINT},"double":{name:"double",wireType:r.WIRE_TYPES.BITS64},string:{name:"string",wireType:r.WIRE_TYPES.LDELIM},bytes:{name:"bytes",wireType:r.WIRE_TYPES.LDELIM},fixed32:{name:"fixed32",wireType:r.WIRE_TYPES.BITS32},sfixed32:{name:"sfixed32",wireType:r.WIRE_TYPES.BITS32},fixed64:{name:"fixed64",wireType:r.WIRE_TYPES.BITS64},sfixed64:{name:"sfixed64",wireType:r.WIRE_TYPES.BITS64},"float":{name:"float",wireType:r.WIRE_TYPES.BITS32},"enum":{name:"enum",wireType:r.WIRE_TYPES.VARINT},message:{name:"message",wireType:r.WIRE_TYPES.LDELIM},group:{name:"group",wireType:r.WIRE_TYPES.STARTGROUP}},r.ID_MIN=1,r.ID_MAX=536870911,r.ByteBuffer=t,r.Long=t.Long||null,r.convertFieldsToCamelCase=!1,r.populateAccessors=!0,r.Util=function(){Object.create||(Object.create=function(e){function t(){}if(arguments.length>1)throw Error("Object.create polyfill only accepts the first parameter.");return t.prototype=e,new t});var t={};t.IS_NODE=!1;try{t.IS_NODE="function"==typeof e&&"function"==typeof e("fs").readFileSync&&"function"==typeof e("path").resolve}catch(r){}return t.XHR=function(){for(var e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],t=null,r=0;r<e.length;r++){try{t=e[r]()}catch(n){continue}break}if(!t)throw Error("XMLHttpRequest is not supported");return t},t.fetch=function(r,n){if(n&&"function"!=typeof n&&(n=null),t.IS_NODE)if(n)e("fs").readFile(r,function(e,t){n(e?null:""+t)});else try{return e("fs").readFileSync(r)}catch(i){return null}else{var o=t.XHR();if(o.open("GET",r,n?!0:!1),o.setRequestHeader("Accept","text/plain"),"function"==typeof o.overrideMimeType&&o.overrideMimeType("text/plain"),!n)return o.send(null),200==o.status||0==o.status&&"string"==typeof o.responseText?o.responseText:null;if(o.onreadystatechange=function(){4==o.readyState&&n(200==o.status||0==o.status&&"string"==typeof o.responseText?o.responseText:null)},4==o.readyState)return;o.send(null)}},t.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},t}(),r.Lang={OPEN:"{",CLOSE:"}",OPTOPEN:"[",OPTCLOSE:"]",OPTEND:",",EQUAL:"=",END:";",STRINGOPEN:'"',STRINGCLOSE:'"',STRINGOPEN_SQ:"'",STRINGCLOSE_SQ:"'",COPTOPEN:"(",COPTCLOSE:")",DELIM:/[\s\{\}=;\[\],'"\(\)]/g,RULE:/^(?:required|optional|repeated)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+|([0-9]*\.[0-9]+([Ee][+-]?[0-9]+)?))$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0x[0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^[0-9]*\.[0-9]+([Ee][+-]?[0-9]+)?$/,ID:/^(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/['"]([^'"\\]*(\\.[^"\\]*)*)['"]/g,BOOL:/^(?:true|false)$/i},r.DotProto=function(e,t){var r={},n=function(e){this.source=""+e,this.index=0,this.line=1,this.stack=[],this.readingString=!1,this.stringEndsWith=t.STRINGCLOSE};n.prototype._readString=function(){t.STRING.lastIndex=this.index-1;var e;if(null!==(e=t.STRING.exec(this.source))){var r=e[1];return this.index=t.STRING.lastIndex,this.stack.push(this.stringEndsWith),r}throw Error("Illegal string value at line "+this.line+", index "+this.index)},n.prototype.next=function(){if(this.stack.length>0)return this.stack.shift();if(this.index>=this.source.length)return null;if(this.readingString)return this.readingString=!1,this._readString();var e,r;do{for(e=!1;t.WHITESPACE.test(r=this.source.charAt(this.index));)if(this.index++,"\n"===r&&this.line++,this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if("/"===this.source.charAt(++this.index)){for(;"\n"!==this.source.charAt(this.index);)if(this.index++,this.index==this.source.length)return null;this.index++,this.line++,e=!0}else{if("*"!==this.source.charAt(this.index))throw Error("Invalid comment at line "+this.line+": /"+this.source.charAt(this.index)+" ('/' or '*' expected)");for(r="";r+(r=this.source.charAt(this.index))!=="*/";)if(this.index++,"\n"===r&&this.line++,this.index===this.source.length)return null;this.index++,e=!0}}while(e);if(this.index===this.source.length)return null;var n=this.index;t.DELIM.lastIndex=0;var i=t.DELIM.test(this.source.charAt(n));if(i)++n;else for(++n;n<this.source.length&&!t.DELIM.test(this.source.charAt(n));)n++;var o=this.source.substring(this.index,this.index=n);return o===t.STRINGOPEN?(this.readingString=!0,this.stringEndsWith=t.STRINGCLOSE):o===t.STRINGOPEN_SQ&&(this.readingString=!0,this.stringEndsWith=t.STRINGCLOSE_SQ),o},n.prototype.peek=function(){if(0===this.stack.length){var e=this.next();if(null===e)return null;this.stack.push(e)}return this.stack[0]},n.prototype.toString=function(){return"Tokenizer("+this.index+"/"+this.source.length+" at line "+this.line+")"},r.Tokenizer=n;var i=function(e){this.tn=new n(e)};return i.prototype.parse=function(){for(var e,t={name:"[ROOT]","package":null,messages:[],enums:[],imports:[],options:{},services:[]},r=!0;e=this.tn.next();)switch(e){case"package":if(!r||null!==t["package"])throw Error("Illegal package at line "+this.tn.line);t["package"]=this._parsePackage(e);break;case"import":if(!r)throw Error("Illegal import at line "+this.tn.line);t.imports.push(this._parseImport(e));break;case"message":this._parseMessage(t,null,e),r=!1;break;case"enum":this._parseEnum(t,e),r=!1;break;case"option":if(!r)throw Error("Illegal option at line "+this.tn.line);this._parseOption(t,e);break;case"service":this._parseService(t,e);break;case"extend":this._parseExtend(t,e);break;case"syntax":this._parseIgnoredStatement(t,e);break;default:throw Error("Illegal token at line "+this.tn.line+": "+e)}return delete t.name,t},i.prototype._parseNumber=function(e){var r=1;if("-"==e.charAt(0)&&(r=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))return r*parseInt(e,10);if(t.NUMBER_HEX.test(e))return r*parseInt(e.substring(2),16);if(t.NUMBER_OCT.test(e))return r*parseInt(e.substring(1),8);if(t.NUMBER_FLT.test(e))return r*parseFloat(e);throw Error("Illegal number at line "+this.tn.line+": "+(0>r?"-":"")+e)},i.prototype._parseId=function(e,r){var n=-1,i=1;if("-"==e.charAt(0)&&(i=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))n=parseInt(e);else if(t.NUMBER_HEX.test(e))n=parseInt(e.substring(2),16);else{if(!t.NUMBER_OCT.test(e))throw Error("Illegal ID at line "+this.tn.line+": "+(0>i?"-":"")+e);n=parseInt(e.substring(1),8)}if(n=i*n|0,!r&&0>n)throw Error("Illegal ID at line "+this.tn.line+": "+(0>i?"-":"")+e);return n},i.prototype._parsePackage=function(e){if(e=this.tn.next(),!t.TYPEREF.test(e))throw Error("Illegal package at line "+this.tn.line+": "+e);var r=e;if(e=this.tn.next(),e!=t.END)throw Error("Illegal end of package at line "+this.tn.line+": "+e+" ('"+t.END+"' expected)");return r},i.prototype._parseImport=function(e){if(e=this.tn.next(),"public"===e&&(e=this.tn.next()),e!==t.STRINGOPEN&&e!==t.STRINGOPEN_SQ)throw Error("Illegal import at line "+this.tn.line+": "+e+" ('"+t.STRINGOPEN+"' or '"+t.STRINGOPEN_SQ+"' expected)");var r=this.tn.next();if(e=this.tn.next(),e!==this.tn.stringEndsWith)throw Error("Illegal import at line "+this.tn.line+": "+e+" ('"+this.tn.stringEndsWith+"' expected)");if(e=this.tn.next(),e!==t.END)throw Error("Illegal import at line "+this.tn.line+": "+e+" ('"+t.END+"' expected)");return r},i.prototype._parseOption=function(e,r){r=this.tn.next();var n=!1;if(r==t.COPTOPEN&&(n=!0,r=this.tn.next()),!t.TYPEREF.test(r)&&!/google\.protobuf\./.test(r))throw Error("Illegal option in message "+e.name+" at line "+this.tn.line+": "+r);var i=r;if(r=this.tn.next(),n){if(r!==t.COPTCLOSE)throw Error("Illegal option in message "+e.name+", option "+i+" at line "+this.tn.line+": "+r+" ('"+t.COPTCLOSE+"' expected)");i="("+i+")",r=this.tn.next(),t.FQTYPEREF.test(r)&&(i+=r,r=this.tn.next())}if(r!==t.EQUAL)throw Error("Illegal option operator in message "+e.name+", option "+i+" at line "+this.tn.line+": "+r+" ('"+t.EQUAL+"' expected)");var o;if(r=this.tn.next(),r===t.STRINGOPEN||r===t.STRINGOPEN_SQ){if(o=this.tn.next(),r=this.tn.next(),r!==this.tn.stringEndsWith)throw Error("Illegal end of option value in message "+e.name+", option "+i+" at line "+this.tn.line+": "+r+" ('"+this.tn.stringEndsWith+"' expected)")}else if(t.NUMBER.test(r))o=this._parseNumber(r,!0);else if(t.BOOL.test(r))o="true"===r;else{if(!t.TYPEREF.test(r))throw Error("Illegal option value in message "+e.name+", option "+i+" at line "+this.tn.line+": "+r);o=r}if(r=this.tn.next(),r!==t.END)throw Error("Illegal end of option in message "+e.name+", option "+i+" at line "+this.tn.line+": "+r+" ('"+t.END+"' expected)");e.options[i]=o},i.prototype._parseIgnoredStatement=function(e,r){for(var n;;){if(n=this.tn.next(),null===n)throw Error("Unexpected EOF in "+e.name+", "+r+" (ignored) at line "+this.tn.line);if(n===t.END)break}},i.prototype._parseService=function(e,r){if(r=this.tn.next(),!t.NAME.test(r))throw Error("Illegal service name at line "+this.tn.line+": "+r);var n=r,i={name:n,rpc:{},options:{}};if(r=this.tn.next(),r!==t.OPEN)throw Error("Illegal OPEN after service "+n+" at line "+this.tn.line+": "+r+" ('"+t.OPEN+"' expected)");do if(r=this.tn.next(),"option"===r)this._parseOption(i,r);else if("rpc"===r)this._parseServiceRPC(i,r);else if(r!==t.CLOSE)throw Error("Illegal type for service "+n+" at line "+this.tn.line+": "+r);while(r!==t.CLOSE);e.services.push(i)},i.prototype._parseServiceRPC=function(e,r){var n=r;if(r=this.tn.next(),!t.NAME.test(r))throw Error("Illegal RPC method name in service "+e.name+" at line "+this.tn.line+": "+r);var i=r,o={request:null,response:null,options:{}};if(r=this.tn.next(),r!==t.COPTOPEN)throw Error("Illegal start of request type in RPC service "+e.name+"#"+i+" at line "+this.tn.line+": "+r+" ('"+t.COPTOPEN+"' expected)");if(r=this.tn.next(),!t.TYPEREF.test(r))throw Error("Illegal request type in RPC service "+e.name+"#"+i+" at line "+this.tn.line+": "+r);if(o.request=r,r=this.tn.next(),r!=t.COPTCLOSE)throw Error("Illegal end of request type in RPC service "+e.name+"#"+i+" at line "+this.tn.line+": "+r+" ('"+t.COPTCLOSE+"' expected)");if(r=this.tn.next(),"returns"!==r.toLowerCase())throw Error("Illegal request/response delimiter in RPC service "+e.name+"#"+i+" at line "+this.tn.line+": "+r+" ('returns' expected)");if(r=this.tn.next(),r!=t.COPTOPEN)throw Error("Illegal start of response type in RPC service "+e.name+"#"+i+" at line "+this.tn.line+": "+r+" ('"+t.COPTOPEN+"' expected)");if(r=this.tn.next(),o.response=r,r=this.tn.next(),r!==t.COPTCLOSE)throw Error("Illegal end of response type in RPC service "+e.name+"#"+i+" at line "+this.tn.line+": "+r+" ('"+t.COPTCLOSE+"' expected)");if(r=this.tn.next(),r===t.OPEN){do if(r=this.tn.next(),"option"===r)this._parseOption(o,r);else if(r!==t.CLOSE)throw Error("Illegal start of option in RPC service "+e.name+"#"+i+" at line "+this.tn.line+": "+r+" ('option' expected)");while(r!==t.CLOSE);this.tn.peek()===t.END&&this.tn.next()}else if(r!==t.END)throw Error("Illegal method delimiter in RPC service "+e.name+"#"+i+" at line "+this.tn.line+": "+r+" ('"+t.END+"' or '"+t.OPEN+"' expected)");"undefined"==typeof e[n]&&(e[n]={}),e[n][i]=o},i.prototype._parseMessage=function(e,r,n){var i={},o="group"===n;if(n=this.tn.next(),!t.NAME.test(n))throw Error("Illegal "+(o?"group":"message")+" name"+(e?" in message "+e.name:"")+" at line "+this.tn.line+": "+n);if(i.name=n,o){if(n=this.tn.next(),n!==t.EQUAL)throw Error("Illegal id assignment after group "+i.name+" at line "+this.tn.line+": "+n+" ('"+t.EQUAL+"' expected)");n=this.tn.next();try{r.id=this._parseId(n)}catch(s){throw Error("Illegal field id value for group "+i.name+"#"+r.name+" at line "+this.tn.line+": "+n)}i.isGroup=!0}if(i.fields=[],i.enums=[],i.messages=[],i.options={},n=this.tn.next(),n===t.OPTOPEN&&r&&(this._parseFieldOptions(i,r,n),n=this.tn.next()),n!==t.OPEN)throw Error("Illegal OPEN after "+(o?"group":"message")+" "+i.name+" at line "+this.tn.line+": "+n+" ('"+t.OPEN+"' expected)");for(;;){if(n=this.tn.next(),n===t.CLOSE){n=this.tn.peek(),n===t.END&&this.tn.next();break}if(t.RULE.test(n))this._parseMessageField(i,n);else if("enum"===n)this._parseEnum(i,n);else if("message"===n)this._parseMessage(i,null,n);else if("option"===n)this._parseOption(i,n);else if("extensions"===n)i.extensions=this._parseExtensions(i,n);else{if("extend"!==n)throw Error("Illegal token in message "+i.name+" at line "+this.tn.line+": "+n+" (type or '"+t.CLOSE+"' expected)");this._parseExtend(i,n)}}return e.messages.push(i),i},i.prototype._parseMessageField=function(e,r){var n={},i=null;if(n.rule=r,n.options={},r=this.tn.next(),"group"===r){if(i=this._parseMessage(e,n,r),!/^[A-Z]/.test(i.name))throw Error("Group names must start with a capital letter");n.type=i.name,n.name=i.name.toLowerCase(),r=this.tn.peek(),r===t.END&&this.tn.next()}else{if(!t.TYPE.test(r)&&!t.TYPEREF.test(r))throw Error("Illegal field type in message "+e.name+" at line "+this.tn.line+": "+r);if(n.type=r,r=this.tn.next(),!t.NAME.test(r))throw Error("Illegal field name in message "+e.name+" at line "+this.tn.line+": "+r);if(n.name=r,r=this.tn.next(),r!==t.EQUAL)throw Error("Illegal field id assignment in message "+e.name+"#"+n.name+" at line "+this.tn.line+": "+r+" ('"+t.EQUAL+"' expected)");r=this.tn.next();try{n.id=this._parseId(r)}catch(o){throw Error("Illegal field id value in message "+e.name+"#"+n.name+" at line "+this.tn.line+": "+r)}if(r=this.tn.next(),r===t.OPTOPEN&&(this._parseFieldOptions(e,n,r),r=this.tn.next()),r!==t.END)throw Error("Illegal field delimiter in message "+e.name+"#"+n.name+" at line "+this.tn.line+": "+r+" ('"+t.END+"' expected)")}e.fields.push(n)},i.prototype._parseFieldOptions=function(e,r,n){for(var i=!0;;){if(n=this.tn.next(),n===t.OPTCLOSE)break;if(n===t.OPTEND){if(i)throw Error("Illegal start of message field options in message "+e.name+"#"+r.name+" at line "+this.tn.line+": "+n);n=this.tn.next()}this._parseFieldOption(e,r,n),i=!1}},i.prototype._parseFieldOption=function(e,r,n){var i=!1;if(n===t.COPTOPEN&&(n=this.tn.next(),i=!0),!t.TYPEREF.test(n))throw Error("Illegal field option in message "+e.name+"#"+r.name+" at line "+this.tn.line+": "+n);var o=n;if(n=this.tn.next(),i){if(n!==t.COPTCLOSE)throw Error("Illegal custom field option name delimiter in message "+e.name+"#"+r.name+" at line "+this.tn.line+": "+n+" (')' expected)");o="("+o+")",n=this.tn.next(),t.FQTYPEREF.test(n)&&(o+=n,n=this.tn.next())}if(n!==t.EQUAL)throw Error("Illegal field option operation in message "+e.name+"#"+r.name+" at line "+this.tn.line+": "+n+" ('=' expected)");var s;if(n=this.tn.next(),n===t.STRINGOPEN||n===t.STRINGOPEN_SQ){if(s=this.tn.next(),n=this.tn.next(),n!=this.tn.stringEndsWith)throw Error("Illegal end of field value in message "+e.name+"#"+r.name+", option "+o+" at line "+this.tn.line+": "+n+" ('"+this.tn.stringEndsWith+"' expected)")}else if(t.NUMBER.test(n,!0))s=this._parseNumber(n,!0);else if(t.BOOL.test(n))s="true"===n.toLowerCase();else{if(!t.TYPEREF.test(n))throw Error("Illegal field option value in message "+e.name+"#"+r.name+", option "+o+" at line "+this.tn.line+": "+n);s=n}r.options[o]=s},i.prototype._parseEnum=function(e,r){var n={};if(r=this.tn.next(),!t.NAME.test(r))throw Error("Illegal enum name in message "+e.name+" at line "+this.tn.line+": "+r);if(n.name=r,r=this.tn.next(),r!==t.OPEN)throw Error("Illegal OPEN after enum "+n.name+" at line "+this.tn.line+": "+r);for(n.values=[],n.options={};;){if(r=this.tn.next(),r===t.CLOSE){r=this.tn.peek(),r===t.END&&this.tn.next();break}if("option"==r)this._parseOption(n,r);else{if(!t.NAME.test(r))throw Error("Illegal enum value name in enum "+n.name+" at line "+this.tn.line+": "+r);this._parseEnumValue(n,r)}}e.enums.push(n)},i.prototype._parseEnumValue=function(e,r){var n={};if(n.name=r,r=this.tn.next(),r!==t.EQUAL)throw Error("Illegal enum value operator in enum "+e.name+" at line "+this.tn.line+": "+r+" ('"+t.EQUAL+"' expected)");r=this.tn.next();try{n.id=this._parseId(r,!0)}catch(i){throw Error("Illegal enum value id in enum "+e.name+" at line "+this.tn.line+": "+r)}if(e.values.push(n),r=this.tn.next(),r===t.OPTOPEN){var o={options:{}};this._parseFieldOptions(e,o,r),r=this.tn.next()}if(r!==t.END)throw Error("Illegal enum value delimiter in enum "+e.name+" at line "+this.tn.line+": "+r+" ('"+t.END+"' expected)")},i.prototype._parseExtensions=function(r,n){var i=[];if(n=this.tn.next(),i.push("min"===n?e.ID_MIN:"max"===n?e.ID_MAX:this._parseNumber(n)),n=this.tn.next(),"to"!==n)throw Error("Illegal extensions delimiter in message "+r.name+" at line "+this.tn.line+" ('to' expected)");if(n=this.tn.next(),i.push("min"===n?e.ID_MIN:"max"===n?e.ID_MAX:this._parseNumber(n)),n=this.tn.next(),n!==t.END)throw Error("Illegal extension delimiter in message "+r.name+" at line "+this.tn.line+": "+n+" ('"+t.END+"' expected)");return i},i.prototype._parseExtend=function(e,r){if(r=this.tn.next(),!t.TYPEREF.test(r))throw Error("Illegal extended message name at line "+this.tn.line+": "+r);var n={};if(n.ref=r,n.fields=[],r=this.tn.next(),r!==t.OPEN)throw Error("Illegal OPEN in extend "+n.name+" at line "+this.tn.line+": "+r+" ('"+t.OPEN+"' expected)");for(;;){if(r=this.tn.next(),r===t.CLOSE){r=this.tn.peek(),r==t.END&&this.tn.next();break}if(!t.RULE.test(r))throw Error("Illegal token in extend "+n.name+" at line "+this.tn.line+": "+r+" (rule or '"+t.CLOSE+"' expected)");this._parseMessageField(n,r)}return e.messages.push(n),n},i.prototype.toString=function(){return"Parser"},r.Parser=i,r}(r,r.Lang),r.Reflect=function(e){function r(t,n){var i=n.readVarint32(),o=7&i,s=i>>3;switch(o){case e.WIRE_TYPES.VARINT:do i=n.readUint8();while(128===(128&i));break;case e.WIRE_TYPES.BITS64:n.offset+=8;break;case e.WIRE_TYPES.LDELIM:i=n.readVarint32(),n.offset+=i;break;case e.WIRE_TYPES.STARTGROUP:r(s,n);break;case e.WIRE_TYPES.ENDGROUP:if(s===t)return!1;throw Error("Illegal GROUPEND after unknown group: "+s+" ("+t+" expected)");case e.WIRE_TYPES.BITS32:n.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+t+": "+o)}return!0}function n(t,r){if(t&&"number"==typeof t.low&&"number"==typeof t.high&&"boolean"==typeof t.unsigned&&t.low===t.low&&t.high===t.high)return new e.Long(t.low,t.high,"undefined"==typeof r?t.unsigned:r);if("string"==typeof t)return e.Long.fromString(t,r||!1,10);if("number"==typeof t)return e.Long.fromNumber(t,r||!1);throw Error("not convertible to Long")}var i={},o=function(e,t){this.parent=e,this.name=t,this.className};o.prototype.fqn=function(){for(var e=this.name,t=this;;){if(t=t.parent,null==t)break;e=t.name+"."+e}return e},o.prototype.toString=function(e){return(e?this.className+" ":"")+this.fqn()},o.prototype.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},i.T=o;var s=function(e,t,r){o.call(this,e,t),this.className="Namespace",this.children=[],this.options=r||{}};s.prototype=Object.create(o.prototype),s.prototype.getChildren=function(e){if(e=e||null,null==e)return this.children.slice();for(var t=[],r=0,n=this.children.length;n>r;++r)this.children[r]instanceof e&&(e===a.Field&&this.children[r]instanceof a.ExtensionField||t.push(this.children[r]));return t},s.prototype.addChild=function(e){var t;if(t=this.getChild(e.name))if(t instanceof a.Field&&t.name!==t.originalName&&!this.hasChild(t.originalName))t.name=t.originalName;else{if(!(e instanceof a.Field&&e.name!==e.originalName)||this.hasChild(e.originalName))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+e.name);e.name=e.originalName}this.children.push(e)},s.prototype.hasChild=function(e){return this._indexOf(e)>-1},s.prototype.getChild=function(e){var t=this._indexOf(e);return t>-1?this.children[t]:null},s.prototype._indexOf=function(e){for(var t="number"==typeof e?"id":"name",r=0;r<this.children.length;r++)if("undefined"!=typeof this.children[r][t]&&this.children[r][t]==e)return r;return-1},s.prototype.resolve=function(e,t){var r=e.split("."),n=this,o=0;if(""==r[o]){for(;null!=n.parent;)n=n.parent;o++}var s;do{do{if(s=n.getChild(r[o]),!s||!(s instanceof i.T)||t&&s instanceof i.Message.Field){n=null;break}n=s,o++}while(o<r.length);if(null!=n)break;if(null!==this.parent)return this.parent.resolve(e,t)}while(null!=n);return n},s.prototype.build=function(){for(var e,t={},r=this.getChildren(),n=0,i=r.length;i>n;++n)e=r[n],e instanceof s&&(t[e.name]=e.build());return Object.defineProperty&&Object.defineProperty(t,"$options",{value:this.buildOpt()}),t},s.prototype.buildOpt=function(){for(var e={},t=Object.keys(this.options),r=0;r<t.length;r++){var n=t[r],i=this.options[t[r]];e[n]=i}return e},s.prototype.getOption=function(e){return"undefined"==typeof e?this.options:"undefined"!=typeof this.options[e]?this.options[e]:null},i.Namespace=s;var a=function(t,r,n,i){s.call(this,t,r,n),this.className="Message",this.extensions=[e.ID_MIN,e.ID_MAX],this.clazz=null,this.isGroup=!!i};a.prototype=Object.create(s.prototype),a.prototype.build=function(r){if(this.clazz&&!r)return this.clazz;for(var n=function(e,r){function n(e,r){var i={};for(var o in e)e.hasOwnProperty(o)&&(null===e[o]||"object"!=typeof e[o]?i[o]=e[o]:e[o]instanceof t?r&&(i[o]=e.toBuffer()):i[o]=n(e[o],r));return i}var i=r.getChildren(e.Reflect.Message.Field),o=function(n){e.Builder.Message.call(this);var o,s;for(Object.defineProperty&&Object.defineProperty(this,"$type",{get:function(){return r}}),o=0;o<i.length;o++)s=i[o],this[s.name]=s.repeated?[]:null;for(o=0;o<i.length;o++)if(s=i[o],"undefined"!=typeof s.options["default"])try{this.$set(s.name,s.options["default"])}catch(a){throw Error("[INTERNAL] "+a)}if(1!=arguments.length||"object"!=typeof n||"function"==typeof n.encode||e.Util.isArray(n)||n instanceof t||n instanceof ArrayBuffer||e.Long&&n instanceof e.Long)for(o=0;o<arguments.length;o++)o<i.length&&this.$set(i[o].name,arguments[o]);else{var f=Object.keys(n);for(o=0;o<f.length;o++)this.$set(f[o],n[f[o]])}};o.prototype=Object.create(e.Builder.Message.prototype),o.prototype.add=function(t,n,i){var o=r.getChild(t);if(!o)throw Error(this+"#"+t+" is undefined");if(!(o instanceof e.Reflect.Message.Field))throw Error(this+"#"+t+" is not a field: "+o.toString(!0));
if(!o.repeated)throw Error(this+"#"+t+" is not a repeated field");null===this[o.name]&&(this[o.name]=[]),this[o.name].push(i?n:o.verifyValue(n,!0))},o.prototype.$add=o.prototype.add,o.prototype.set=function(t,n,i){var o=r.getChild(t);if(!o)throw Error(this+"#"+t+" is not a field: undefined");if(!(o instanceof e.Reflect.Message.Field))throw Error(this+"#"+t+" is not a field: "+o.toString(!0));this[o.name]=i?n:o.verifyValue(n)},o.prototype.$set=o.prototype.set,o.prototype.get=function(t){var n=r.getChild(t);if(!(n&&n instanceof e.Reflect.Message.Field))throw Error(this+"#"+t+" is not a field: undefined");if(!(n instanceof e.Reflect.Message.Field))throw Error(this+"#"+t+" is not a field: "+n.toString(!0));return this[n.name]},o.prototype.$get=o.prototype.get;for(var s=0;s<i.length;s++){var a=i[s];e.populateAccessors&&function(e){var t=e.originalName.replace(/(_[a-zA-Z])/g,function(e){return e.toUpperCase().replace("_","")});t=t.substring(0,1).toUpperCase()+t.substring(1);var n=e.originalName.replace(/([A-Z])/g,function(e){return"_"+e});r.hasChild("set"+t)||(o.prototype["set"+t]=function(t){this.$set(e.name,t)}),r.hasChild("set_"+n)||(o.prototype["set_"+n]=function(t){this.$set(e.name,t)}),r.hasChild("get"+t)||(o.prototype["get"+t]=function(){return this.$get(e.name)}),r.hasChild("get_"+n)||(o.prototype["get_"+n]=function(){return this.$get(e.name)})}(a)}o.prototype.encode=function(e){var n=!1;e||(e=new t,n=!0);var i=e.littleEndian;try{return r.encode(this,e.LE()),(n?e.flip():e).LE(i)}catch(o){throw e.LE(i),o}},o.prototype.calculate=function(){return r.calculate(this)},o.prototype.encodeDelimited=function(e){var n=!1;e||(e=new t,n=!0);var i=(new t).LE();return r.encode(this,i).flip(),e.writeVarint32(i.remaining()),e.append(i),n?e.flip():e},o.prototype.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toArrayBuffer()),e}},o.prototype.toArrayBuffer=o.prototype.encodeAB,o.prototype.encodeNB=function(){try{return this.encode().toBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBuffer()),e}},o.prototype.toBuffer=o.prototype.encodeNB,o.prototype.encode64=function(){try{return this.encode().toBase64()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBase64()),e}},o.prototype.toBase64=o.prototype.encode64,o.prototype.encodeHex=function(){try{return this.encode().toHex()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toHex()),e}},o.prototype.toHex=o.prototype.encodeHex,o.prototype.toRaw=function(e){return n(this,!!e)},o.decode=function(e,n){"string"==typeof e&&(e=t.wrap(e,n?n:"base64")),e=e instanceof t?e:t.wrap(e);var i=e.littleEndian;try{var o=r.decode(e.LE());return e.LE(i),o}catch(s){throw e.LE(i),s}},o.decodeDelimited=function(e,n){if("string"==typeof e&&(e=t.wrap(e,n?n:"base64")),e=e instanceof t?e:t.wrap(e),e.remaining()<1)return null;var i=e.offset,o=e.readVarint32();if(e.remaining()<o)return e.offset=i,null;try{var s=r.decode(e.slice(e.offset,e.offset+o).LE());return e.offset+=o,s}catch(a){throw e.offset+=o,a}},o.decode64=function(e){return o.decode(e,"base64")},o.decodeHex=function(e){return o.decode(e,"hex")},o.prototype.toString=function(){return r.toString()};return Object.defineProperty&&Object.defineProperty(o,"$options",{value:r.buildOpt()}),o}(e,this),i=this.getChildren(),o=0;o<i.length;o++)if(i[o]instanceof h)n[i[o].name]=i[o].build();else if(i[o]instanceof a)n[i[o].name]=i[o].build();else if(!(i[o]instanceof a.Field))throw Error("Illegal reflect child of "+this.toString(!0)+": "+i[o].toString(!0));return this.clazz=n},a.prototype.encode=function(e,t){for(var r,n=this.getChildren(a.Field),i=null,o=0;o<n.length;o++)r=e.$get(n[o].name),n[o].required&&null===r?null===i&&(i=n[o]):n[o].encode(r,t);if(null!==i){var s=Error("Missing at least one required field for "+this.toString(!0)+": "+i);throw s.encoded=t,s}return t},a.prototype.calculate=function(e){for(var t,r=this.getChildren(a.Field),n=0,i=0;i<r.length;i++){if(t=e.$get(r[i].name),r[i].required&&null===t)throw Error("Missing at least one required field for "+this.toString(!0)+": "+r[i]);n+=r[i].calculate(t)}return n},a.prototype.decode=function(t,n,i){n="number"==typeof n?n:-1;for(var o,s,a,f=t.offset,l=new this.clazz;t.offset<f+n||-1==n&&t.remaining()>0;){if(o=t.readVarint32(),s=7&o,a=o>>3,s===e.WIRE_TYPES.ENDGROUP){if(a!==i)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+a+" ("+(i?i+" expected":"not a group")+")");break}var h=this.getChild(a);if(h)h.repeated&&!h.options.packed?l.$add(h.name,h.decode(s,t),!0):l.$set(h.name,h.decode(s,t),!0);else switch(s){case e.WIRE_TYPES.VARINT:t.readVarint32();break;case e.WIRE_TYPES.BITS32:t.offset+=4;break;case e.WIRE_TYPES.BITS64:t.offset+=8;break;case e.WIRE_TYPES.LDELIM:var u=t.readVarint32();t.offset+=u;break;case e.WIRE_TYPES.STARTGROUP:for(;r(a,t););break;default:throw Error("Illegal wire type for unknown field "+a+" in "+this.toString(!0)+"#decode: "+s)}}for(var p=this.getChildren(e.Reflect.Field),c=0;c<p.length;c++)if(p[c].required&&null===l[p[c].name]){var d=Error("Missing at least one required field for "+this.toString(!0)+": "+p[c].name);throw d.decoded=l,d}return l},i.Message=a;var f=function(t,r,n,i,s,a){o.call(this,t,i),this.className="Message.Field",this.required="required"==r,this.repeated="repeated"==r,this.type=n,this.resolvedType=null,this.id=s,this.options=a||{},this.originalName=this.name,e.convertFieldsToCamelCase&&(this.name=this.name.replace(/_([a-zA-Z])/g,function(e,t){return t.toUpperCase()}))};f.prototype=Object.create(o.prototype),f.prototype.verifyValue=function(r,i){i=i||!1;var o=function(e,t){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+e+" ("+t+")")}.bind(this);if(null===r)return this.required&&o(typeof r,"required"),null;var s;if(this.repeated&&!i){e.Util.isArray(r)||(r=[r]);var a=[];for(s=0;s<r.length;s++)a.push(this.verifyValue(r[s],!0));return a}switch(!this.repeated&&e.Util.isArray(r)&&o(typeof r,"no array expected"),this.type){case e.TYPES.int32:case e.TYPES.sint32:case e.TYPES.sfixed32:return("number"!=typeof r||r===r&&r%1!==0)&&o(typeof r,"not an integer"),r>4294967295?0|r:r;case e.TYPES.uint32:case e.TYPES.fixed32:return("number"!=typeof r||r===r&&r%1!==0)&&o(typeof r,"not an integer"),0>r?r>>>0:r;case e.TYPES.int64:case e.TYPES.sint64:case e.TYPES.sfixed64:if(e.Long)try{return n(r,!1)}catch(f){o(typeof r,f.message)}else o(typeof r,"requires Long.js");case e.TYPES.uint64:case e.TYPES.fixed64:if(e.Long)try{return n(r,!0)}catch(f){o(typeof r,f.message)}else o(typeof r,"requires Long.js");case e.TYPES.bool:return"boolean"!=typeof r&&o(typeof r,"not a boolean"),r;case e.TYPES["float"]:case e.TYPES["double"]:return"number"!=typeof r&&o(typeof r,"not a number"),r;case e.TYPES.string:return"string"==typeof r||r&&r instanceof String||o(typeof r,"not a string"),""+r;case e.TYPES.bytes:return r&&r instanceof t?r:t.wrap(r);case e.TYPES["enum"]:var l=this.resolvedType.getChildren(h.Value);for(s=0;s<l.length;s++){if(l[s].name==r)return l[s].id;if(l[s].id==r)return l[s].id}o(r,"not a valid enum value");case e.TYPES.group:case e.TYPES.message:return r&&"object"==typeof r||o(typeof r,"object expected"),r instanceof this.resolvedType.clazz?r:new this.resolvedType.clazz(r)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+r+" (undefined type "+this.type+")")},f.prototype.encode=function(r,n){if(r=this.verifyValue(r),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===r||this.repeated&&0==r.length)return n;try{if(this.repeated){var i;if(this.options.packed&&e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){n.writeVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),n.ensureCapacity(n.offset+=1);var o=n.offset;for(i=0;i<r.length;i++)this.encodeValue(r[i],n);var s=n.offset-o,a=t.calculateVarint32(s);if(a>1){var f=n.slice(o,n.offset);o+=a-1,n.offset=o,n.append(f)}n.writeVarint32(s,o-a)}else for(i=0;i<r.length;i++)n.writeVarint32(this.id<<3|this.type.wireType),this.encodeValue(r[i],n)}else n.writeVarint32(this.id<<3|this.type.wireType),this.encodeValue(r,n)}catch(l){throw Error("Illegal value for "+this.toString(!0)+": "+r+" ("+l+")")}return n},f.prototype.encodeValue=function(r,n){if(null===r)return n;switch(this.type){case e.TYPES.int32:0>r?n.writeVarint64(r):n.writeVarint32(r);break;case e.TYPES.uint32:n.writeVarint32(r);break;case e.TYPES.sint32:n.writeVarint32ZigZag(r);break;case e.TYPES.fixed32:n.writeUint32(r);break;case e.TYPES.sfixed32:n.writeInt32(r);break;case e.TYPES.int64:case e.TYPES.uint64:n.writeVarint64(r);break;case e.TYPES.sint64:n.writeVarint64ZigZag(r);break;case e.TYPES.fixed64:n.writeUint64(r);break;case e.TYPES.sfixed64:n.writeInt64(r);break;case e.TYPES.bool:n.writeVarint32("string"==typeof r?"false"===r.toLowerCase()?0:!!r:r?1:0);break;case e.TYPES["enum"]:n.writeVarint32(r);break;case e.TYPES["float"]:n.writeFloat32(r);break;case e.TYPES["double"]:n.writeFloat64(r);break;case e.TYPES.string:n.writeVString(r);break;case e.TYPES.bytes:if(r.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+r.remaining()+" bytes remaining");var i=r.offset;n.writeVarint32(r.remaining()),n.append(r),r.offset=i;break;case e.TYPES.message:var o=(new t).LE();this.resolvedType.encode(r,o),n.writeVarint32(o.offset),n.append(o.flip());break;case e.TYPES.group:this.resolvedType.encode(r,n),n.writeVarint32(this.id<<3|e.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+r+" (unknown type)")}return n},f.prototype.calculate=function(r){if(r=this.verifyValue(r),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===r||this.repeated&&0==r.length)return 0;var n=0;try{if(this.repeated){var i,o;if(this.options.packed&&e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(n+=t.calculateVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),o=0,i=0;i<r.length;i++)o+=this.calculateValue(r[i]);n+=t.calculateVarint32(o),n+=o}else for(i=0;i<r.length;i++)n+=t.calculateVarint32(this.id<<3|this.type.wireType),n+=this.calculateValue(r[i])}else n+=t.calculateVarint32(this.id<<3|this.type.wireType),n+=this.calculateValue(r)}catch(s){throw Error("Illegal value for "+this.toString(!0)+": "+r+" ("+s+")")}return n},f.prototype.calculateValue=function(r){if(null===r)return 0;var n;switch(this.type){case e.TYPES.int32:return 0>r?t.calculateVarint64(r):t.calculateVarint32(r);case e.TYPES.uint32:return t.calculateVarint32(r);case e.TYPES.sint32:return t.calculateVarint32(t.zigZagEncode32(r));case e.TYPES.fixed32:case e.TYPES.sfixed32:case e.TYPES["float"]:return 4;case e.TYPES.int64:case e.TYPES.uint64:return t.calculateVarint64(r);case e.TYPES.sint64:return t.calculateVarint64(t.zigZagEncode64(r));case e.TYPES.fixed64:case e.TYPES.sfixed64:return 8;case e.TYPES.bool:return 1;case e.TYPES["enum"]:return t.calculateVarint32(r);case e.TYPES["double"]:return 8;case e.TYPES.string:return n=t.calculateUTF8Bytes(r),t.calculateVarint32(n)+n;case e.TYPES.bytes:if(r.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+r.remaining()+" bytes remaining");return t.calculateVarint32(r.remaining())+r.remaining();case e.TYPES.message:return n=this.resolvedType.calculate(r),t.calculateVarint32(n)+n;case e.TYPES.group:return n=this.resolvedType.calculate(r),n+t.calculateVarint32(this.id<<3|e.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+r+" (unknown type)")},f.prototype.decode=function(t,r,n){var i,o;if(t!=this.type.wireType&&(n||t!=e.WIRE_TYPES.LDELIM||!this.repeated))throw Error("Illegal wire type for field "+this.toString(!0)+": "+t+" ("+this.type.wireType+" expected)");if(t==e.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0&&!n){o=r.readVarint32(),o=r.offset+o;for(var s=[];r.offset<o;)s.push(this.decode(this.type.wireType,r,!0));return s}switch(this.type){case e.TYPES.int32:return 0|r.readVarint32();case e.TYPES.uint32:return r.readVarint32()>>>0;case e.TYPES.sint32:return 0|r.readVarint32ZigZag();case e.TYPES.fixed32:return r.readUint32()>>>0;case e.TYPES.sfixed32:return 0|r.readInt32();case e.TYPES.int64:return r.readVarint64();case e.TYPES.uint64:return r.readVarint64().toUnsigned();case e.TYPES.sint64:return r.readVarint64ZigZag();case e.TYPES.fixed64:return r.readUint64();case e.TYPES.sfixed64:return r.readInt64();case e.TYPES.bool:return!!r.readVarint32();case e.TYPES["enum"]:return r.readVarint32();case e.TYPES["float"]:return r.readFloat();case e.TYPES["double"]:return r.readDouble();case e.TYPES.string:return r.readVString();case e.TYPES.bytes:if(o=r.readVarint32(),r.remaining()<o)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+o+" required but got only "+r.remaining());return i=r.clone(),i.limit=i.offset+o,r.offset+=o,i;case e.TYPES.message:return o=r.readVarint32(),this.resolvedType.decode(r,o);case e.TYPES.group:return this.resolvedType.decode(r,-1,this.id)}throw Error("[INTERNAL] Illegal wire type for "+this.toString(!0)+": "+t)},i.Message.Field=f;var l=function(e,t,r,n,i,o){f.call(this,e,t,r,n,i,o)};l.prototype=Object.create(f.prototype),i.Message.ExtensionField=l;var h=function(e,t,r){s.call(this,e,t,r),this.className="Enum",this.object=null};h.prototype=Object.create(s.prototype),h.prototype.build=function(){for(var e={},t=this.getChildren(h.Value),r=0;r<t.length;r++)e[t[r].name]=t[r].id;return Object.defineProperty&&Object.defineProperty(e,"$options",{value:this.buildOpt()}),this.object=e},i.Enum=h;var u=function(e,t,r){o.call(this,e,t),this.className="Enum.Value",this.id=r};u.prototype=Object.create(o.prototype),i.Enum.Value=u;var p=function(e,t,r){s.call(this,e,t,r),this.className="Service",this.clazz=null};p.prototype=Object.create(s.prototype),p.prototype.build=function(t){return this.clazz&&!t?this.clazz:this.clazz=function(e,t){var r=function(t){e.Builder.Service.call(this),this.rpcImpl=t||function(e,t,r){setTimeout(r.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}};r.prototype=Object.create(e.Builder.Service.prototype),Object.defineProperty&&(Object.defineProperty(r,"$options",{value:t.buildOpt()}),Object.defineProperty(r.prototype,"$options",{value:r.$options}));for(var n=t.getChildren(e.Reflect.Service.RPCMethod),i=0;i<n.length;i++)!function(e){r.prototype[e.name]=function(r,n){try{if(!(r&&r instanceof e.resolvedRequestType.clazz))return void setTimeout(n.bind(this,Error("Illegal request type provided to service method "+t.name+"#"+e.name)),0);this.rpcImpl(e.fqn(),r,function(r,i){if(r)return void n(r);try{i=e.resolvedResponseType.clazz.decode(i)}catch(o){}return i&&i instanceof e.resolvedResponseType.clazz?void n(null,i):void n(Error("Illegal response type received in service method "+t.name+"#"+e.name))})}catch(i){setTimeout(n.bind(this,i),0)}},r[e.name]=function(t,n,i){new r(t)[e.name](n,i)},Object.defineProperty&&(Object.defineProperty(r[e.name],"$options",{value:e.buildOpt()}),Object.defineProperty(r.prototype[e.name],"$options",{value:r[e.name].$options}))}(n[i]);return r}(e,this)},i.Service=p;var c=function(e,t,r){o.call(this,e,t),this.className="Service.Method",this.options=r||{}};c.prototype=Object.create(o.prototype),c.prototype.buildOpt=s.prototype.buildOpt,i.Service.Method=c;var d=function(e,t,r,n,i){c.call(this,e,t,i),this.className="Service.RPCMethod",this.requestName=r,this.responseName=n,this.resolvedRequestType=null,this.resolvedResponseType=null};return d.prototype=Object.create(c.prototype),i.Service.RPCMethod=d,i}(r),r.Builder=function(t,r,n){var i=function(){this.ns=new n.Namespace(null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null};return i.prototype.reset=function(){this.ptr=this.ns},i.prototype.define=function(e,t){if("string"!=typeof e||!r.TYPEREF.test(e))throw Error("Illegal package: "+e);var i,o=e.split(".");for(i=0;i<o.length;i++)if(!r.NAME.test(o[i]))throw Error("Illegal package: "+o[i]);for(i=0;i<o.length;i++)this.ptr.hasChild(o[i])||this.ptr.addChild(new n.Namespace(this.ptr,o[i],t)),this.ptr=this.ptr.getChild(o[i]);return this},i.isValidMessage=function(e){if("string"!=typeof e.name||!r.NAME.test(e.name))return!1;if("undefined"!=typeof e.values||"undefined"!=typeof e.rpc)return!1;var n;if("undefined"!=typeof e.fields){if(!t.Util.isArray(e.fields))return!1;var o,s=[];for(n=0;n<e.fields.length;n++){if(!i.isValidMessageField(e.fields[n]))return!1;if(o=parseInt(e.fields[n].id,10),s.indexOf(o)>=0)return!1;s.push(o)}s=null}if("undefined"!=typeof e.enums){if(!t.Util.isArray(e.enums))return!1;for(n=0;n<e.enums.length;n++)if(!i.isValidEnum(e.enums[n]))return!1}if("undefined"!=typeof e.messages){if(!t.Util.isArray(e.messages))return!1;for(n=0;n<e.messages.length;n++)if(!i.isValidMessage(e.messages[n])&&!i.isValidExtend(e.messages[n]))return!1}return"undefined"==typeof e.extensions||t.Util.isArray(e.extensions)&&2===e.extensions.length&&"number"==typeof e.extensions[0]&&"number"==typeof e.extensions[1]?!0:!1},i.isValidMessageField=function(e){if("string"!=typeof e.rule||"string"!=typeof e.name||"string"!=typeof e.type||"undefined"==typeof e.id)return!1;if(!(r.RULE.test(e.rule)&&r.NAME.test(e.name)&&r.TYPEREF.test(e.type)&&r.ID.test(""+e.id)))return!1;if("undefined"!=typeof e.options){if("object"!=typeof e.options)return!1;for(var t,n=Object.keys(e.options),i=0;i<n.length;i++)if("string"!=typeof(t=n[i])||"string"!=typeof e.options[t]&&"number"!=typeof e.options[t]&&"boolean"!=typeof e.options[t])return!1}return!0},i.isValidEnum=function(e){if("string"!=typeof e.name||!r.NAME.test(e.name))return!1;if("undefined"==typeof e.values||!t.Util.isArray(e.values)||0==e.values.length)return!1;for(var n=0;n<e.values.length;n++){if("object"!=typeof e.values[n])return!1;if("string"!=typeof e.values[n].name||"undefined"==typeof e.values[n].id)return!1;if(!r.NAME.test(e.values[n].name)||!r.NEGID.test(""+e.values[n].id))return!1}return!0},i.prototype.create=function(e){if(!e)return this;if(t.Util.isArray(e)||(e=[e]),0==e.length)return this;var r,o,s,a,f,l=[];for(l.push(e);l.length>0;){if(e=l.pop(),!t.Util.isArray(e))throw Error("Not a valid namespace: "+JSON.stringify(e));for(;e.length>0;){if(r=e.shift(),i.isValidMessage(r)){if(o=new n.Message(this.ptr,r.name,r.options,r.isGroup),r.fields&&r.fields.length>0)for(a=0;a<r.fields.length;a++){if(o.hasChild(r.fields[a].id))throw Error("Duplicate field id in message "+o.name+": "+r.fields[a].id);if(r.fields[a].options){for(s=Object.keys(r.fields[a].options),f=0;f<s.length;f++){if("string"!=typeof s[f])throw Error("Illegal field option name in message "+o.name+"#"+r.fields[a].name+": "+s[f]);if("string"!=typeof r.fields[a].options[s[f]]&&"number"!=typeof r.fields[a].options[s[f]]&&"boolean"!=typeof r.fields[a].options[s[f]])throw Error("Illegal field option value in message "+o.name+"#"+r.fields[a].name+"#"+s[f]+": "+r.fields[a].options[s[f]])}s=null}o.addChild(new n.Message.Field(o,r.fields[a].rule,r.fields[a].type,r.fields[a].name,r.fields[a].id,r.fields[a].options))}if(s=[],"undefined"!=typeof r.enums&&r.enums.length>0)for(a=0;a<r.enums.length;a++)s.push(r.enums[a]);if(r.messages&&r.messages.length>0)for(a=0;a<r.messages.length;a++)s.push(r.messages[a]);if(r.extensions&&(o.extensions=r.extensions,o.extensions[0]<t.ID_MIN&&(o.extensions[0]=t.ID_MIN),o.extensions[1]>t.ID_MAX&&(o.extensions[1]=t.ID_MAX)),this.ptr.addChild(o),s.length>0){l.push(e),e=s,s=null,this.ptr=o,o=null;continue}s=null,o=null}else if(i.isValidEnum(r)){for(o=new n.Enum(this.ptr,r.name,r.options),a=0;a<r.values.length;a++)o.addChild(new n.Enum.Value(o,r.values[a].name,r.values[a].id));this.ptr.addChild(o),o=null}else if(i.isValidService(r)){o=new n.Service(this.ptr,r.name,r.options);for(a in r.rpc)r.rpc.hasOwnProperty(a)&&o.addChild(new n.Service.RPCMethod(o,a,r.rpc[a].request,r.rpc[a].response,r.rpc[a].options));this.ptr.addChild(o),o=null}else{if(!i.isValidExtend(r))throw Error("Not a valid definition: "+JSON.stringify(r));if(o=this.ptr.resolve(r.ref))for(a=0;a<r.fields.length;a++){if(o.hasChild(r.fields[a].id))throw Error("Duplicate extended field id in message "+o.name+": "+r.fields[a].id);if(r.fields[a].id<o.extensions[0]||r.fields[a].id>o.extensions[1])throw Error("Illegal extended field id in message "+o.name+": "+r.fields[a].id+" ("+o.extensions.join(" to ")+" expected)");o.addChild(new n.Message.Field(o,r.fields[a].rule,r.fields[a].type,r.fields[a].name,r.fields[a].id,r.fields[a].options))}else if(!/\.?google\.protobuf\./.test(r.ref))throw Error("Extended message "+r.ref+" is not defined")}r=null}e=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},i.prototype["import"]=function(r,n){if("string"==typeof n){if(t.Util.IS_NODE&&(n=e("path").resolve(n)),this.files[n]===!0)return this.reset(),this;this.files[n]=!0}if(r.imports&&r.imports.length>0){var i,o="/",s=!1;"object"==typeof n?(this.importRoot=n.root,s=!0,i=this.importRoot,n=n.file,(i.indexOf("\\")>=0||n.indexOf("\\")>=0)&&(o="\\")):"string"==typeof n?this.importRoot?i=this.importRoot:n.indexOf("/")>=0?(i=n.replace(/\/[^\/]*$/,""),""===i&&(i="/")):n.indexOf("\\")>=0?(i=n.replace(/\\[^\\]*$/,""),o="\\"):i=".":i=null;for(var a=0;a<r.imports.length;a++)if("string"==typeof r.imports[a]){if(!i)throw Error("Cannot determine import root: File name is unknown");var f=r.imports[a];if(/^google\/protobuf\//.test(f))continue;if(f=i+o+f,this.files[f]===!0)continue;/\.proto$/i.test(f)&&!t.DotProto&&(f=f.replace(/\.proto$/,".json"));var l=t.Util.fetch(f);if(null===l)throw Error("Failed to import '"+f+"' in '"+n+"': File not found");/\.json$/i.test(f)?this["import"](JSON.parse(l+""),f):this["import"](new t.DotProto.Parser(l+"").parse(),f)}else n?/\.(\w+)$/.test(n)?this["import"](r.imports[a],n.replace(/^(.+)\.(\w+)$/,function(e,t,r){return t+"_import"+a+"."+r})):this["import"](r.imports[a],n+"_import"+a):this["import"](r.imports[a]);s&&(this.importRoot=null)}return r.messages&&(r["package"]&&this.define(r["package"],r.options),this.create(r.messages),this.reset()),r.enums&&(r["package"]&&this.define(r["package"],r.options),this.create(r.enums),this.reset()),r.services&&(r["package"]&&this.define(r["package"],r.options),this.create(r.services),this.reset()),r["extends"]&&(r["package"]&&this.define(r["package"],r.options),this.create(r["extends"]),this.reset()),this},i.isValidService=function(e){return!("string"!=typeof e.name||!r.NAME.test(e.name)||"object"!=typeof e.rpc)},i.isValidExtend=function(e){if("string"!=typeof e.ref||!r.TYPEREF.test(e.ref))return!1;var n;if("undefined"!=typeof e.fields){if(!t.Util.isArray(e.fields))return!1;var o,s=[];for(n=0;n<e.fields.length;n++){if(!i.isValidMessageField(e.fields[n]))return!1;if(o=parseInt(e.id,10),s.indexOf(o)>=0)return!1;s.push(o)}s=null}return!0},i.prototype.resolveAll=function(){var e;if(null!=this.ptr&&"object"!=typeof this.ptr.type){if(this.ptr instanceof n.Namespace)for(var i=this.ptr.getChildren(),o=0;o<i.length;o++)this.ptr=i[o],this.resolveAll();else if(this.ptr instanceof n.Message.Field)if(r.TYPE.test(this.ptr.type))this.ptr.type=t.TYPES[this.ptr.type];else{if(!r.TYPEREF.test(this.ptr.type))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(e=this.ptr.parent.resolve(this.ptr.type,!0),!e)throw Error("Unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=e,e instanceof n.Enum)this.ptr.type=t.TYPES["enum"];else{if(!(e instanceof n.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=e.isGroup?t.TYPES.group:t.TYPES.message}}else if(this.ptr instanceof t.Reflect.Enum.Value);else{if(!(this.ptr instanceof t.Reflect.Service.Method))throw Error("Illegal object in namespace: "+typeof this.ptr+":"+this.ptr);if(!(this.ptr instanceof t.Reflect.Service.RPCMethod))throw Error("Illegal service type in "+this.ptr.toString(!0));if(e=this.ptr.parent.resolve(this.ptr.requestName),!(e&&e instanceof t.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=e,e=this.ptr.parent.resolve(this.ptr.responseName),!(e&&e instanceof t.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=e}this.reset()}},i.prototype.build=function(e){if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null==this.result&&(this.result=this.ns.build()),e){for(var t=e.split("."),r=this.result,n=0;n<t.length;n++){if(!r[t[n]]){r=null;break}r=r[t[n]]}return r}return this.result},i.prototype.lookup=function(e){return e?this.ns.resolve(e):this.ns},i.prototype.toString=function(){return"Builder"},i.Message=function(){},i.Service=function(){},i}(r,r.Lang,r.Reflect),r.loadProto=function(e,t,n){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(n=t,t=null),r.loadJson(new r.DotProto.Parser(e).parse(),t,n)},r.protoFromString=r.loadProto,r.loadProtoFile=function(e,t,n){if(t&&"object"==typeof t?(n=t,t=null):t&&"function"==typeof t||(t=null),t)return r.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,function(i){if(null===i)return void t(Error("Failed to fetch file"));try{t(null,r.loadProto(i,n,e))}catch(o){t(o)}});var i=r.Util.fetch("object"==typeof e?e.root+"/"+e.file:e);return null===i?null:r.loadProto(i,n,e)},r.protoFromFile=r.loadProtoFile,r.newBuilder=function(e,t){var n=new r.Builder;return"undefined"!=typeof e&&null!==e&&n.define(e,t),n},r.loadJson=function(e,t,n){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(n=t,t=null),t&&"object"==typeof t||(t=r.newBuilder()),"string"==typeof e&&(e=JSON.parse(e)),t["import"](e,n),t.resolveAll(),t.build(),t},r.loadJsonFile=function(e,t,n){if(t&&"object"==typeof t?(n=t,t=null):t&&"function"==typeof t||(t=null),t)return r.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,function(i){if(null===i)return void t(Error("Failed to fetch file"));try{t(null,r.loadJson(JSON.parse(i),n,e))}catch(o){t(o)}});var i=r.Util.fetch("object"==typeof e?e.root+"/"+e.file:e);return null===i?null:r.loadJson(JSON.parse(i),n,e)},r}"undefined"!=typeof t&&t.exports?t.exports=n(e("bytebuffer")):"function"==typeof define&&define.amd?define(["ByteBuffer"],n):(r.dcodeIO=r.dcodeIO||{}).ProtoBuf=n(r.dcodeIO.ByteBuffer)}(this)},{bytebuffer:31,fs:15,path:17}],30:[function(e,t){var r=e("./dist/ProtoBuf.js");t.exports=r},{"./dist/ProtoBuf.js":29}],31:[function(e,t){!function(r){function n(e){function t(e,n,i){if("undefined"==typeof e&&(e=t.DEFAULT_CAPACITY),"undefined"==typeof n&&(n=t.DEFAULT_ENDIAN),"undefined"==typeof i&&(i=t.DEFAULT_NOASSERT),!i){if(e|=0,0>e)throw new RangeError("Illegal capacity: 0 <= "+e);if("boolean"!=typeof n)throw new TypeError("Illegal littleEndian: Not a boolean");if("boolean"!=typeof i)throw new TypeError("Illegal noAssert: Not a boolean")}this.buffer=0===e?r:new ArrayBuffer(e),this.view=0===e?null:new DataView(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=e,this.littleEndian="undefined"!=typeof n?!!n:!1,this.noAssert=!!i}t.VERSION="3.1.0",t.LITTLE_ENDIAN=!0,t.BIG_ENDIAN=!1,t.DEFAULT_CAPACITY=16,t.DEFAULT_ENDIAN=t.BIG_ENDIAN,t.DEFAULT_NOASSERT=!1,t.Long=e||null;var r=new ArrayBuffer(0);t.allocate=function(e,r,n){return new t(e,r,n)},t.concat=function(e,r,n,i){("boolean"==typeof r||"string"!=typeof r)&&(i=n,n=r,r=void 0);for(var o,s=0,a=0,f=e.length;f>a;++a)t.isByteBuffer(e[a])||(e[a]=t.wrap(e[a],r)),o=e[a].limit-e[a].offset,o>0&&(s+=o);if(0===s)return new t(0,n,i);for(r=new t(s,n,i),i=new Uint8Array(r.buffer),a=0;f>a;)n=e[a++],o=n.limit-n.offset,0>=o||(i.set(new Uint8Array(n.buffer).subarray(n.offset,n.limit),r.offset),r.offset+=o);return r.limit=r.offset,r.offset=0,r},t.isByteBuffer=function(e){return e&&e instanceof t},t.type=function(){return ArrayBuffer},t.wrap=function(e,r,n,o){if("string"!=typeof r&&(o=n,n=r,r=void 0),"string"==typeof e)switch("undefined"==typeof r&&(r="utf8"),r){case"base64":return t.fromBase64(e,n);case"hex":return t.fromHex(e,n);case"binary":return t.fromBinary(e,n);case"utf8":return t.fromUTF8(e,n);case"debug":return t.fromDebug(e,n);default:throw new TypeError("Unsupported encoding: "+r)}if(null===e||"object"!=typeof e)throw new TypeError("Illegal buffer: null or non-object");if(t.isByteBuffer(e))return r=t.prototype.clone.call(e),r.markedOffset=-1,r;if(e instanceof Uint8Array)r=new t(0,n,o),0<e.length&&(r.buffer=e.buffer,r.offset=e.byteOffset,r.limit=e.byteOffset+e.length,r.view=0<e.length?new DataView(e.buffer):null);else if(e instanceof ArrayBuffer)r=new t(0,n,o),0<e.byteLength&&(r.buffer=e,r.offset=0,r.limit=e.byteLength,r.view=0<e.byteLength?new DataView(e):null);else{if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Illegal buffer");for(r=new t(e.length,n,o),r.limit=e.length,i=0;i<e.length;++i)r.view.setUint8(i,e[i])}return r},t.prototype.writeInt8=function(e,t){var r="undefined"==typeof t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||0!==t%1)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=1;var n=this.buffer.byteLength;return t>n&&this.resize((n*=2)>t?n:t),this.view.setInt8(t-1,e),r&&(this.offset+=1),this},t.prototype.writeByte=t.prototype.writeInt8,t.prototype.readInt8=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return e=this.view.getInt8(e),t&&(this.offset+=1),e},t.prototype.readByte=t.prototype.readInt8,t.prototype.writeUint8=function(e,t){var r="undefined"==typeof t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||0!==t%1)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=1;var n=this.buffer.byteLength;return t>n&&this.resize((n*=2)>t?n:t),this.view.setUint8(t-1,e),r&&(this.offset+=1),this},t.prototype.readUint8=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return e=this.view.getUint8(e),t&&(this.offset+=1),e},t.prototype.writeInt16=function(e,t){var r="undefined"==typeof t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||0!==t%1)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=2;var n=this.buffer.byteLength;return t>n&&this.resize((n*=2)>t?n:t),this.view.setInt16(t-2,e,this.littleEndian),r&&(this.offset+=2),this},t.prototype.writeShort=t.prototype.writeInt16,t.prototype.readInt16=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+2>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}return e=this.view.getInt16(e,this.littleEndian),t&&(this.offset+=2),e},t.prototype.readShort=t.prototype.readInt16,t.prototype.writeUint16=function(e,t){var r="undefined"==typeof t;
if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||0!==t%1)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=2;var n=this.buffer.byteLength;return t>n&&this.resize((n*=2)>t?n:t),this.view.setUint16(t-2,e,this.littleEndian),r&&(this.offset+=2),this},t.prototype.readUint16=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+2>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}return e=this.view.getUint16(e,this.littleEndian),t&&(this.offset+=2),e},t.prototype.writeInt32=function(e,t){var r="undefined"==typeof t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||0!==t%1)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var n=this.buffer.byteLength;return t>n&&this.resize((n*=2)>t?n:t),this.view.setInt32(t-4,e,this.littleEndian),r&&(this.offset+=4),this},t.prototype.writeInt=t.prototype.writeInt32,t.prototype.readInt32=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+4>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return e=this.view.getInt32(e,this.littleEndian),t&&(this.offset+=4),e},t.prototype.readInt=t.prototype.readInt32,t.prototype.writeUint32=function(e,t){var r="undefined"==typeof t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||0!==t%1)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var n=this.buffer.byteLength;return t>n&&this.resize((n*=2)>t?n:t),this.view.setUint32(t-4,e,this.littleEndian),r&&(this.offset+=4),this},t.prototype.readUint32=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+4>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return e=this.view.getUint32(e,this.littleEndian),t&&(this.offset+=4),e},e&&(t.prototype.writeInt64=function(t,r){var n="undefined"==typeof r;if(n&&(r=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if(!(t&&t instanceof e))throw new TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof r||0!==r%1)throw new TypeError("Illegal offset: "+r+" (not an integer)");if(r>>>=0,0>r||r+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t&&(t=e.fromNumber(t)),r+=8;var i=this.buffer.byteLength;return r>i&&this.resize((i*=2)>r?i:r),r-=8,this.littleEndian?(this.view.setInt32(r,t.low,!0),this.view.setInt32(r+4,t.high,!0)):(this.view.setInt32(r,t.high,!1),this.view.setInt32(r+4,t.low,!1)),n&&(this.offset+=8),this},t.prototype.writeLong=t.prototype.writeInt64,t.prototype.readInt64=function(t){var r="undefined"==typeof t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof t||0!==t%1)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+8>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}return t=this.littleEndian?new e(this.view.getInt32(t,!0),this.view.getInt32(t+4,!0),!1):new e(this.view.getInt32(t+4,!1),this.view.getInt32(t,!1),!1),r&&(this.offset+=8),t},t.prototype.readLong=t.prototype.readInt64,t.prototype.writeUint64=function(t,r){var n="undefined"==typeof r;if(n&&(r=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if(!(t&&t instanceof e))throw new TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof r||0!==r%1)throw new TypeError("Illegal offset: "+r+" (not an integer)");if(r>>>=0,0>r||r+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t&&(t=e.fromNumber(t)),r+=8;var i=this.buffer.byteLength;return r>i&&this.resize((i*=2)>r?i:r),r-=8,this.littleEndian?(this.view.setInt32(r,t.low,!0),this.view.setInt32(r+4,t.high,!0)):(this.view.setInt32(r,t.high,!1),this.view.setInt32(r+4,t.low,!1)),n&&(this.offset+=8),this},t.prototype.readUint64=function(t){var r="undefined"==typeof t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof t||0!==t%1)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+8>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}return t=this.littleEndian?new e(this.view.getInt32(t,!0),this.view.getInt32(t+4,!0),!0):new e(this.view.getInt32(t+4,!1),this.view.getInt32(t,!1),!0),r&&(this.offset+=8),t}),t.prototype.writeFloat32=function(e,t){var r="undefined"==typeof t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw new TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||0!==t%1)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var n=this.buffer.byteLength;return t>n&&this.resize((n*=2)>t?n:t),this.view.setFloat32(t-4,e,this.littleEndian),r&&(this.offset+=4),this},t.prototype.writeFloat=t.prototype.writeFloat32,t.prototype.readFloat32=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+4>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return e=this.view.getFloat32(e,this.littleEndian),t&&(this.offset+=4),e},t.prototype.readFloat=t.prototype.readFloat32,t.prototype.writeFloat64=function(e,t){var r="undefined"==typeof t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw new TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||0!==t%1)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=8;var n=this.buffer.byteLength;return t>n&&this.resize((n*=2)>t?n:t),this.view.setFloat64(t-8,e,this.littleEndian),r&&(this.offset+=8),this},t.prototype.writeDouble=t.prototype.writeFloat64,t.prototype.readFloat64=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+8>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}return e=this.view.getFloat64(e,this.littleEndian),t&&(this.offset+=8),e},t.prototype.readDouble=t.prototype.readFloat64,t.MAX_VARINT32_BYTES=5,t.calculateVarint32=function(e){return e>>>=0,128>e?1:16384>e?2:2097152>e?3:268435456>e?4:5},t.zigZagEncode32=function(e){return((e|=0)<<1^e>>31)>>>0},t.zigZagDecode32=function(e){return e>>>1^-(1&e)|0},t.prototype.writeVarint32=function(e,r){var n="undefined"==typeof r;if(n&&(r=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof r||0!==r%1)throw new TypeError("Illegal offset: "+r+" (not an integer)");if(r>>>=0,0>r||r+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.byteLength)}var i=t.calculateVarint32(e);r+=i;var o=this.buffer.byteLength;return r>o&&this.resize((o*=2)>r?o:r),r-=i,this.view.setUint8(r,i=128|e),e>>>=0,e>=128?(i=e>>7|128,this.view.setUint8(r+1,i),e>=16384?(i=e>>14|128,this.view.setUint8(r+2,i),e>=2097152?(i=e>>21|128,this.view.setUint8(r+3,i),e>=268435456?(this.view.setUint8(r+4,e>>28&15),i=5):(this.view.setUint8(r+3,127&i),i=4)):(this.view.setUint8(r+2,127&i),i=3)):(this.view.setUint8(r+1,127&i),i=2)):(this.view.setUint8(r,127&i),i=1),n?(this.offset+=i,this):i},t.prototype.writeVarint32ZigZag=function(e,r){return this.writeVarint32(t.zigZagEncode32(e),r)},t.prototype.readVarint32=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var r,n=0,i=0;do r=this.view.getUint8(e+n),5>n&&(i|=(127&r)<<7*n>>>0),++n;while(128===(128&r));return i|=0,t?(this.offset+=n,i):{value:i,length:n}},t.prototype.readVarint32ZigZag=function(e){return e=this.readVarint32(e),"object"==typeof e?e.value=t.zigZagDecode32(e.value):e=t.zigZagDecode32(e),e},e&&(t.MAX_VARINT64_BYTES=10,t.calculateVarint64=function(t){"number"==typeof t&&(t=e.fromNumber(t));var r=t.toInt()>>>0,n=t.shiftRightUnsigned(28).toInt()>>>0;return t=t.shiftRightUnsigned(56).toInt()>>>0,0==t?0==n?16384>r?128>r?1:2:2097152>r?3:4:16384>n?128>n?5:6:2097152>n?7:8:128>t?9:10},t.zigZagEncode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):!1!==t.unsigned&&(t=t.toSigned()),t.shiftLeft(1).xor(t.shiftRight(63)).toUnsigned()},t.zigZagDecode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):!1!==t.unsigned&&(t=t.toSigned()),t.shiftRightUnsigned(1).xor(t.and(e.ONE).toSigned().negate()).toSigned()},t.prototype.writeVarint64=function(r,n){var i="undefined"==typeof n;if(i&&(n=this.offset),!this.noAssert){if("number"==typeof r)r=e.fromNumber(r);else if(!(r&&r instanceof e))throw new TypeError("Illegal value: "+r+" (not an integer or Long)");if("number"!=typeof n||0!==n%1)throw new TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}"number"==typeof r?r=e.fromNumber(r,!1):!1!==r.unsigned&&(r=r.toSigned());var o=t.calculateVarint64(r),s=r.toInt()>>>0,a=r.shiftRightUnsigned(28).toInt()>>>0,f=r.shiftRightUnsigned(56).toInt()>>>0;n+=o;var l=this.buffer.byteLength;switch(n>l&&this.resize((l*=2)>n?l:n),n-=o,o){case 10:this.view.setUint8(n+9,f>>>7&1);case 9:this.view.setUint8(n+8,9!==o?128|f:127&f);case 8:this.view.setUint8(n+7,8!==o?a>>>21|128:a>>>21&127);case 7:this.view.setUint8(n+6,7!==o?a>>>14|128:a>>>14&127);case 6:this.view.setUint8(n+5,6!==o?a>>>7|128:a>>>7&127);case 5:this.view.setUint8(n+4,5!==o?128|a:127&a);case 4:this.view.setUint8(n+3,4!==o?s>>>21|128:s>>>21&127);case 3:this.view.setUint8(n+2,3!==o?s>>>14|128:s>>>14&127);case 2:this.view.setUint8(n+1,2!==o?s>>>7|128:s>>>7&127);case 1:this.view.setUint8(n,1!==o?128|s:127&s)}return i?(this.offset+=o,this):o},t.prototype.writeVarint64ZigZag=function(e,r){return this.writeVarint64(t.zigZagEncode64(e),r)},t.prototype.readVarint64=function(t){var r="undefined"==typeof t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof t||0!==t%1)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n=t,i=0,o=0,s=0,a=0,a=this.view.getUint8(t++),i=127&a;if(128&a&&(a=this.view.getUint8(t++),i|=(127&a)<<7,128&a&&(a=this.view.getUint8(t++),i|=(127&a)<<14,128&a&&(a=this.view.getUint8(t++),i|=(127&a)<<21,128&a&&(a=this.view.getUint8(t++),o=127&a,128&a&&(a=this.view.getUint8(t++),o|=(127&a)<<7,128&a&&(a=this.view.getUint8(t++),o|=(127&a)<<14,128&a&&(a=this.view.getUint8(t++),o|=(127&a)<<21,128&a&&(a=this.view.getUint8(t++),s=127&a,128&a&&(a=this.view.getUint8(t++),s|=(127&a)<<7,128&a))))))))))throw Error("Data must be corrupt: Buffer overrun");return i=e.from28Bits(i,o,s,!1),r?(this.offset=t,i):{value:i,length:t-n}},t.prototype.readVarint64ZigZag=function(r){return(r=this.readVarint64(r))&&r.value instanceof e?r.value=t.zigZagDecode64(r.value):r=t.zigZagDecode64(r),r}),t.prototype.writeCString=function(e,t){var r="undefined"==typeof t;r&&(t=this.offset);var n,i=e.length;if(!this.noAssert){if("string"!=typeof e)throw new TypeError("Illegal str: Not a string");for(n=0;i>n;++n)if(0===e.charCodeAt(n))throw new RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof t||0!==t%1)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}n=t,i=o.b(o.a(e))[1],t+=i+1;var s=this.buffer.byteLength;return t>s&&this.resize((s*=2)>t?s:t),t-=i+1,o.e(o.a(e),function(e){this.view.setUint8(t++,e)}.bind(this)),this.view.setUint8(t++,0),r?(this.offset=t-n,this):i},t.prototype.readCString=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var r,n=e,i=-1;return o.d(function(){if(0===i)return null;if(e>=this.limit)throw RangeError("Illegal range: Truncated data, "+e+" < "+this.limit);return 0===(i=this.view.getUint8(e++))?null:i}.bind(this),r=o.c(),!0),t?(this.offset=e,r()):{string:r(),length:e-n}},t.prototype.writeIString=function(e,t){var r="undefined"==typeof t;if(r&&(t=this.offset),!this.noAssert){if("string"!=typeof e)throw new TypeError("Illegal str: Not a string");if("number"!=typeof t||0!==t%1)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var n,i=t;n=o.b(o.a(e),this.noAssert)[1],t+=4+n;var s=this.buffer.byteLength;if(t>s&&this.resize((s*=2)>t?s:t),t-=4+n,this.view.setUint32(t,n,this.littleEndian),t+=4,o.e(o.a(e),function(e){this.view.setUint8(t++,e)}.bind(this)),t!==i+4+n)throw new RangeError("Illegal range: Truncated data, "+t+" == "+(t+4+n));return r?(this.offset=t,this):t-i},t.prototype.readIString=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+4>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var r=0,n=e,r=this.view.getUint32(e,this.littleEndian);e+=4;var i=e+r;return o.d(function(){return i>e?this.view.getUint8(e++):null}.bind(this),r=o.c(),this.noAssert),r=r(),t?(this.offset=e,r):{string:r,length:e-n}},t.METRICS_CHARS="c",t.METRICS_BYTES="b",t.prototype.writeUTF8String=function(e,t){var r="undefined"==typeof t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof t||0!==t%1)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var n,i=t;n=o.b(o.a(e))[1],t+=n;var s=this.buffer.byteLength;return t>s&&this.resize((s*=2)>t?s:t),t-=n,o.e(o.a(e),function(e){this.view.setUint8(t++,e)}.bind(this)),r?(this.offset=t,this):t-i},t.prototype.writeString=t.prototype.writeUTF8String,t.calculateUTF8Chars=function(e){return o.b(o.a(e))[0]},t.calculateUTF8Bytes=function(e){return o.b(o.a(e))[1]},t.prototype.readUTF8String=function(e,r,n){"number"==typeof r&&(n=r,r=void 0);var i="undefined"==typeof n;if(i&&(n=this.offset),"undefined"==typeof r&&(r=t.METRICS_CHARS),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal length: "+e+" (not an integer)");if(e|=0,"number"!=typeof n||0!==n%1)throw new TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}var s,a=0,f=n;if(r===t.METRICS_CHARS){if(s=o.c(),o.i(function(){return e>a&&n<this.limit?this.view.getUint8(n++):null}.bind(this),function(e){++a,o.g(e,s)}.bind(this)),a!==e)throw new RangeError("Illegal range: Truncated data, "+a+" == "+e);return i?(this.offset=n,s()):{string:s(),length:n-f}}if(r===t.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof n||0!==n%1)throw new TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+e>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+n+" (+"+e+") <= "+this.buffer.byteLength)}var l=n+e;if(o.d(function(){return l>n?this.view.getUint8(n++):null}.bind(this),s=o.c(),this.noAssert),n!==l)throw new RangeError("Illegal range: Truncated data, "+n+" == "+l);return i?(this.offset=n,s()):{string:s(),length:n-f}}throw new TypeError("Unsupported metrics: "+r)},t.prototype.readString=t.prototype.readUTF8String,t.prototype.writeVString=function(e,r){var n="undefined"==typeof r;if(n&&(r=this.offset),!this.noAssert){if("string"!=typeof e)throw new TypeError("Illegal str: Not a string");if("number"!=typeof r||0!==r%1)throw new TypeError("Illegal offset: "+r+" (not an integer)");if(r>>>=0,0>r||r+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.byteLength)}var i,s,a=r;i=o.b(o.a(e),this.noAssert)[1],s=t.calculateVarint32(i),r+=s+i;var f=this.buffer.byteLength;if(r>f&&this.resize((f*=2)>r?f:r),r-=s+i,r+=this.writeVarint32(i,r),o.e(o.a(e),function(e){this.view.setUint8(r++,e)}.bind(this)),r!==a+i+s)throw new RangeError("Illegal range: Truncated data, "+r+" == "+(r+i+s));return n?(this.offset=r,this):r-a},t.prototype.readVString=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var r=this.readVarint32(e),n=e;e+=r.length;var r=r.value,i=e+r,r=o.c();return o.d(function(){return i>e?this.view.getUint8(e++):null}.bind(this),r,this.noAssert),r=r(),t?(this.offset=e,r):{string:r,length:e-n}},t.prototype.append=function(e,r,n){("number"==typeof r||"string"!=typeof r)&&(n=r,r=void 0);var i="undefined"==typeof n;if(i&&(n=this.offset),!this.noAssert){if("number"!=typeof n||0!==n%1)throw new TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}if(e instanceof t||(e=t.wrap(e,r)),r=e.limit-e.offset,0>=r)return this;n+=r;var o=this.buffer.byteLength;return n>o&&this.resize((o*=2)>n?o:n),new Uint8Array(this.buffer,n-r).set(new Uint8Array(e.buffer).subarray(e.offset,e.limit)),e.offset+=r,i&&(this.offset+=r),this},t.prototype.appendTo=function(e,t){return e.append(this,t),this},t.prototype.assert=function(e){return this.noAssert=!e,this},t.prototype.capacity=function(){return this.buffer.byteLength},t.prototype.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},t.prototype.clone=function(e){var r=new t(0,this.littleEndian,this.noAssert);return e?(e=new ArrayBuffer(this.buffer.byteLength),new Uint8Array(e).set(this.buffer),r.buffer=e,r.view=new DataView(e)):(r.buffer=this.buffer,r.view=this.view),r.offset=this.offset,r.markedOffset=this.markedOffset,r.limit=this.limit,r},t.prototype.compact=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||0!==t%1)throw new TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(0===e&&t===this.buffer.byteLength)return this;var n=t-e;if(0===n)return this.buffer=r,this.view=null,0<=this.markedOffset&&(this.markedOffset-=e),this.limit=this.offset=0,this;var i=new ArrayBuffer(n);return new Uint8Array(i).set(new Uint8Array(this.buffer).subarray(e,t)),this.buffer=i,this.view=new DataView(i),0<=this.markedOffset&&(this.markedOffset-=e),this.offset=0,this.limit=n,this},t.prototype.copy=function(e,r){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof r&&(r=this.limit),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof r||0!==r%1)throw new TypeError("Illegal end: Not an integer");if(r>>>=0,0>e||e>r||r>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+r+" <= "+this.buffer.byteLength)}if(e===r)return new t(0,this.littleEndian,this.noAssert);var n=r-e,i=new t(n,this.littleEndian,this.noAssert);return i.offset=0,i.limit=n,0<=i.markedOffset&&(i.markedOffset-=e),this.copyTo(i,0,e,r),i},t.prototype.copyTo=function(e,r,n,i){var o,s;if(!this.noAssert&&!t.isByteBuffer(e))throw new TypeError("Illegal target: Not a ByteBuffer");if(r=(s="undefined"==typeof r)?e.offset:0|r,n=(o="undefined"==typeof n)?this.offset:0|n,i="undefined"==typeof i?this.limit:0|i,0>r||r>e.buffer.byteLength)throw new RangeError("Illegal target range: 0 <= "+r+" <= "+e.buffer.byteLength);if(0>n||i>this.buffer.byteLength)throw new RangeError("Illegal source range: 0 <= "+n+" <= "+this.buffer.byteLength);var a=i-n;return 0===a?e:(e.ensureCapacity(r+a),new Uint8Array(e.buffer).set(new Uint8Array(this.buffer).subarray(n,i),r),o&&(this.offset+=a),s&&(e.offset+=a),this)},t.prototype.ensureCapacity=function(e){var t=this.buffer.byteLength;return e>t?this.resize((t*=2)>e?t:e):this},t.prototype.fill=function(e,t,r){var n="undefined"==typeof t;if(n&&(t=this.offset),"string"==typeof e&&0<e.length&&(e=e.charCodeAt(0)),"undefined"==typeof t&&(t=this.offset),"undefined"==typeof r&&(r=this.limit),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||0!==t%1)throw new TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof r||0!==r%1)throw new TypeError("Illegal end: Not an integer");if(r>>>=0,0>t||t>r||r>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+t+" <= "+r+" <= "+this.buffer.byteLength)}if(t>=r)return this;for(;r>t;)this.view.setUint8(t++,e);return n&&(this.offset=t),this},t.prototype.flip=function(){return this.limit=this.offset,this.offset=0,this},t.prototype.mark=function(e){if(e="undefined"==typeof e?this.offset:e,!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=e,this},t.prototype.order=function(e){if(!this.noAssert&&"boolean"!=typeof e)throw new TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!e,this},t.prototype.LE=function(e){return this.littleEndian="undefined"!=typeof e?!!e:!0,this},t.prototype.BE=function(e){return this.littleEndian="undefined"!=typeof e?!e:!1,this},t.prototype.prepend=function(e,r,n){("number"==typeof r||"string"!=typeof r)&&(n=r,r=void 0);var i="undefined"==typeof n;if(i&&(n=this.offset),!this.noAssert){if("number"!=typeof n||0!==n%1)throw new TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}if(e instanceof t||(e=t.wrap(e,r)),r=e.limit-e.offset,0>=r)return this;var o,s=r-n;if(s>0){var a=new ArrayBuffer(this.buffer.byteLength+s);o=new Uint8Array(a),o.set(new Uint8Array(this.buffer).subarray(n,this.buffer.byteLength),r),this.buffer=a,this.view=new DataView(a),this.offset+=s,0<=this.markedOffset&&(this.markedOffset+=s),this.limit+=s,n+=s}else o=new Uint8Array(this.buffer);return o.set(new Uint8Array(e.buffer).subarray(e.offset,e.limit),n-r),e.offset=e.limit,i&&(this.offset-=r),this},t.prototype.prependTo=function(e,t){return e.prepend(this,t),this},t.prototype.printDebug=function(e){"function"!=typeof e&&(e=console.log.bind(console)),e(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},t.prototype.remaining=function(){return this.limit-this.offset},t.prototype.reset=function(){return 0<=this.markedOffset?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},t.prototype.resize=function(e){if(!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal capacity: "+e+" (not an integer)");if(e|=0,0>e)throw new RangeError("Illegal capacity: 0 <= "+e)}return this.buffer.byteLength<e&&(e=new ArrayBuffer(e),new Uint8Array(e).set(new Uint8Array(this.buffer)),this.buffer=e,this.view=new DataView(e)),this},t.prototype.reverse=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||0!==t%1)throw new TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}return e===t?this:(Array.prototype.reverse.call(new Uint8Array(this.buffer).subarray(e,t)),this.view=new DataView(this.buffer),this)},t.prototype.skip=function(e){if(!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal length: "+e+" (not an integer)");e|=0}var t=this.offset+e;if(!this.noAssert&&(0>t||t>this.buffer.byteLength))throw new RangeError("Illegal length: 0 <= "+this.offset+" + "+e+" <= "+this.buffer.byteLength);return this.offset=t,this},t.prototype.slice=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||0!==t%1)throw new TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var r=this.clone();return r.offset=e,r.limit=t,r},t.prototype.toBuffer=function(e){var t=this.offset,n=this.limit;if(t>n)var i=t,t=n,n=i;if(!this.noAssert){if("number"!=typeof t||0!==t%1)throw new TypeError("Illegal offset: Not an integer");if(t>>>=0,"number"!=typeof n||0!==n%1)throw new TypeError("Illegal limit: Not an integer");if(n>>>=0,0>t||t>n||n>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+t+" <= "+n+" <= "+this.buffer.byteLength)}return e||0!==t||n!==this.buffer.byteLength?t===n?r:(e=new ArrayBuffer(n-t),new Uint8Array(e).set(new Uint8Array(this.buffer).subarray(t,n),0),e):this.buffer},t.prototype.toArrayBuffer=t.prototype.toBuffer,t.prototype.toString=function(e){if("undefined"==typeof e)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch(e){case"utf8":return this.toUTF8();case"base64":return this.toBase64();case"hex":return this.toHex();case"binary":return this.toBinary();case"debug":return this.toDebug();case"columns":return this.o();default:throw Error("Unsupported encoding: "+e)}};var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=n+"";t.prototype.toBase64=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||0!==t%1)throw new TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(e===t)return"";for(var r,i,o,s,a,f,l="";t>e;)r=this.view.getUint8(e++),i=(s=t>e)?this.view.getUint8(e++):0,o=(a=t>e)?this.view.getUint8(e++):0,f=r>>2,r=(3&r)<<4|i>>4,i=(15&i)<<2|o>>6,o&=63,a||(o=64,s||(i=64)),l+=n.charAt(f)+n.charAt(r)+n.charAt(i)+n.charAt(o);return l},t.fromBase64=function(e,r,i){if(!i){if("string"!=typeof e)throw new TypeError("Illegal str: Not a string");if(0!==e.length%4)throw new TypeError("Illegal str: Length not a multiple of 4")}var o,s=e.length,a=0;for(o=e.length-1;o>=0&&"="===e.charAt(o);--o)a++;if(a>2)throw new TypeError("Illegal str: Suffix is too large");if(0===s)return new t(0,r,i);var f,l,h,u=new t(s/4*3-a,r,i);for(r=o=0;s>o;){if(a=n.indexOf(e.charAt(o++)),f=s>o?n.indexOf(e.charAt(o++)):0,l=s>o?n.indexOf(e.charAt(o++)):0,h=s>o?n.indexOf(e.charAt(o++)):0,!i&&(0>a||0>f||0>l||0>h))throw new TypeError("Illegal str: Contains non-base64 characters");u.view.setUint8(r++,a<<2|f>>4),64!==l&&(u.view.setUint8(r++,f<<4&240|l>>2,r),64!==h&&u.view.setUint8(r++,l<<6&192|h))}return u.limit=r,u},t.btoa=function(e){return t.fromBinary(e).toBase64()},t.atob=function(e){return t.fromBase64(e).toBinary()},t.prototype.toBinary=function(e,t){if(e="undefined"==typeof e?this.offset:e,t="undefined"==typeof t?this.limit:t,!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||0!==t%1)throw new TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(e===t)return"";for(var r=[];t>e;)r.push(this.view.getUint8(e++));return String.fromCharCode.apply(String,r)},t.fromBinary=function(e,r,n){if(!n&&"string"!=typeof e)throw new TypeError("Illegal str: Not a string");for(var i=0,o=e.length,s=new t(o,r,n);o>i;){if(r=e.charCodeAt(i),!n&&r>255)throw new TypeError("Illegal charCode at "+i+": 0 <= "+r+" <= 255");s.view.setUint8(i++,r)}return s.limit=o,s},t.prototype.toDebug=function(e){for(var t,r=-1,n=this.buffer.byteLength,i="",o="",s="";n>r;){if(-1!==r&&(t=this.view.getUint8(r),i=16>t?i+("0"+t.toString(16).toUpperCase()):i+t.toString(16).toUpperCase(),e&&(o+=t>32&&127>t?String.fromCharCode(t):".")),++r,e&&r>0&&0===r%16&&r!==n){for(;51>i.length;)i+=" ";s+=i+o+"\n",i=o=""}i=r===this.offset&&r===this.limit?i+(r===this.markedOffset?"!":"|"):r===this.offset?i+(r===this.markedOffset?"[":"<"):r===this.limit?i+(r===this.markedOffset?"]":">"):i+(r===this.markedOffset?"'":e||0!==r&&r!==n?" ":"")}if(e&&" "!==i){for(;51>i.length;)i+=" ";s+=i+o+"\n"}return e?s:i},t.fromDebug=function(e,r,n){var i=e.length;r=new t((i+1)/3|0,r,n);for(var o,s=0,a=0,f=!1,l=!1,h=!1,u=!1,p=!1;i>s;){switch(o=e.charAt(s++)){case"!":if(!n){if(l||h||u){p=!0;break}l=h=u=!0}r.offset=r.markedOffset=r.limit=a,f=!1;break;case"|":if(!n){if(l||u){p=!0;break}l=u=!0}r.offset=r.limit=a,f=!1;break;case"[":if(!n){if(l||h){p=!0;break}l=h=!0}r.offset=r.markedOffset=a,f=!1;break;case"<":if(!n){if(l){p=!0;break}l=!0}r.offset=a,f=!1;break;case"]":if(!n){if(u||h){p=!0;break}u=h=!0}r.limit=r.markedOffset=a,f=!1;break;case">":if(!n){if(u){p=!0;break}u=!0}r.limit=a,f=!1;break;case"'":if(!n){if(h){p=!0;break}h=!0}r.markedOffset=a,f=!1;break;case" ":f=!1;break;default:if(!n&&f){p=!0;break}if(o=parseInt(o+e.charAt(s++),16),!n&&(isNaN(o)||0>o||o>255))throw new TypeError("Illegal str: Not a debug encoded string");r.view.setUint8(a++,o),f=!0}if(p)throw new TypeError("Illegal str: Invalid symbol at "+s)}if(!n){if(!l||!u)throw new TypeError("Illegal str: Missing offset or limit");if(a<r.buffer.byteLength)throw new TypeError("Illegal str: Not a debug encoded string (is it hex?) "+a+" < "+i)}return r},t.prototype.toHex=function(e,t){if(e="undefined"==typeof e?this.offset:e,t="undefined"==typeof t?this.limit:t,!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal begin: Not an integer");
if(e>>>=0,"number"!=typeof t||0!==t%1)throw new TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}for(var r,n=Array(t-e);t>e;)r=this.view.getUint8(e++),16>r?n.push("0",r.toString(16)):n.push(r.toString(16));return n.join("")},t.fromHex=function(e,r,n){if(!n){if("string"!=typeof e)throw new TypeError("Illegal str: Not a string");if(0!==e.length%2)throw new TypeError("Illegal str: Length not a multiple of 2")}var i=e.length;r=new t(i/2|0,r);for(var o,s=0,a=0;i>s;s+=2){if(o=parseInt(e.substring(s,s+2),16),!n&&(!isFinite(o)||0>o||o>255))throw new TypeError("Illegal str: Contains non-hex characters");r.view.setUint8(a++,o)}return r.limit=a,r};var o=function(){var e={j:function(e,t){var r=null;for("number"==typeof e&&(r=e,e=function(){return null});null!==r||null!==(r=e());)128>r?t(127&r):(2048>r?t(r>>6&31|192):(65536>r?t(r>>12&15|224):(t(r>>18&7|240),t(r>>12&63|128)),t(r>>6&63|128)),t(63&r|128)),r=null},i:function(e,t){function r(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t}for(var n,i,o,s;null!==(n=e());)if(0===(128&n))t(n);else if(192===(224&n))null===(i=e())&&r([n,i]),t((31&n)<<6|63&i);else if(224===(240&n))null!==(i=e())&&null!==(o=e())||r([n,i,o]),t((15&n)<<12|(63&i)<<6|63&o);else{if(240!==(248&n))throw RangeError("Illegal starting byte: "+n);null!==(i=e())&&null!==(o=e())&&null!==(s=e())||r([n,i,o,s]),t((7&n)<<18|(63&i)<<12|(63&o)<<6|63&s)}},f:function(e,t){for(var r,n=null;null!==(r=null!==n?n:e());)r>=55296&&57343>=r&&null!==(n=e())&&n>=56320&&57343>=n?(t(1024*(r-55296)+n-56320+65536),n=null):t(r);null!==n&&t(n)},g:function(e,t){var r=null;for("number"==typeof e&&(r=e,e=function(){return null});null!==r||null!==(r=e());)65535>=r?t(r):(r-=65536,t((r>>10)+55296),t(r%1024+56320)),r=null},e:function(t,r){e.f(t,function(t){e.j(t,r)})},d:function(t,r){e.i(t,function(t){e.g(t,r)})},k:function(e){if("number"!=typeof e||e!==e)throw TypeError("Illegal byte: "+typeof e);if(-128>e||e>255)throw RangeError("Illegal byte: "+e);return e},l:function(e){if("number"!=typeof e||e!==e)throw TypeError("Illegal char code: "+typeof e);if(0>e||e>65535)throw RangeError("Illegal char code: "+e);return e},m:function(e){if("number"!=typeof e||e!==e)throw TypeError("Illegal code point: "+typeof e);if(0>e||e>1114111)throw RangeError("Illegal code point: "+e);return e},h:function(e){return 128>e?1:2048>e?2:65536>e?3:4},n:function(t){for(var r,n=0;null!==(r=t());)n+=e.h(r);return n},b:function(t){var r=0,n=0;return e.f(t,function(t){++r,n+=e.h(t)}),[r,n]}};return e}(),s=String.fromCharCode;return o.a=function(e){var t=0;return function(){return t<e.length?e.charCodeAt(t++):null}},o.c=function(){var e=[],t=[];return function(){return 0===arguments.length?t.join("")+s.apply(String,e):(1024<e.length+arguments.length&&(t.push(s.apply(String,e)),e.length=0),void Array.prototype.push.apply(e,arguments))}},t.prototype.toUTF8=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||0!==e%1)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||0!==t%1)throw new TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var r,n=this;try{o.d(function(){return t>e?n.view.getUint8(e++):null},r=o.c())}catch(i){if(e!==t)throw new RangeError("Illegal range: Truncated data, "+e+" != "+t)}return r()},t.fromUTF8=function(e,r,n){if(!n&&"string"!=typeof e)throw new TypeError("Illegal str: Not a string");var i=new t(o.b(o.a(e),!0)[1],r,n),s=0;return o.e(o.a(e),function(e){i.view.setUint8(s++,e)}),i.limit=s,i},t}"undefined"!=typeof t&&t.exports?t.exports=n(e("long")):"undefined"!=typeof define&&define.amd?define("ByteBuffer",["Math/Long"],function(e){return n(e)}):(r.dcodeIO||(r.dcodeIO={}),r.dcodeIO.ByteBuffer=n(r.dcodeIO.Long))}(this)},{"long":33}],32:[function(e,t){!function(e){"use strict";var r=function(e,t,r){e&&"object"==typeof e&&(t=e.high,r=e.unsigned,e=e.low),this.low=0|e,this.high=0|t,this.unsigned=!!r},n={},i={};r.fromInt=function(e,t){var o,s;return t?(e>>>=0,e>=0&&256>e&&(s=i[e])?s:(o=new r(e,0>(0|e)?-1:0,!0),e>=0&&256>e&&(i[e]=o),o)):(e=0|e,e>=-128&&128>e&&(s=n[e])?s:(o=new r(e,0>e?-1:0,!1),e>=-128&&128>e&&(n[e]=o),o))},r.fromNumber=function(e,t){return t=!!t,isNaN(e)||!isFinite(e)?r.ZERO:!t&&-f>=e?r.MIN_SIGNED_VALUE:t&&0>=e?r.MIN_UNSIGNED_VALUE:!t&&e+1>=f?r.MAX_SIGNED_VALUE:t&&e>=a?r.MAX_UNSIGNED_VALUE:0>e?r.fromNumber(-e,!1).negate():new r(e%s|0,e/s|0,t)},r.fromBits=function(e,t,n){return new r(e,t,n)},r.from28Bits=function(e,t,n,i){return r.fromBits(e|t<<28,t>>>4|n<<24,i)},r.fromString=function(e,t,n){if(0==e.length)throw new Error("number format error: empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return r.ZERO;if("number"==typeof t&&(n=t,t=!1),n=n||10,2>n||n>36)throw new Error("radix out of range: "+n);if("-"==e.charAt(0))return r.fromString(e.substring(1),t,n).negate();if(e.indexOf("-")>=0)throw new Error('number format error: interior "-" character: '+e);for(var i=r.fromNumber(Math.pow(n,8)),o=r.ZERO,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),f=parseInt(e.substring(s,s+a),n);if(8>a){var l=r.fromNumber(Math.pow(n,a));o=o.multiply(l).add(r.fromNumber(f))}else o=o.multiply(i),o=o.add(r.fromNumber(f))}return o.unsigned=t,o};var o=65536,s=o*o,a=s*s,f=a/2,l=r.fromInt(1<<24);r.ZERO=r.fromInt(0),r.UZERO=r.fromInt(0,!0),r.ONE=r.fromInt(1),r.UONE=r.fromInt(1,!0),r.NEG_ONE=r.fromInt(-1),r.MAX_SIGNED_VALUE=r.fromBits(-1,2147483647,!1),r.MAX_UNSIGNED_VALUE=r.fromBits(-1,-1,!0),r.MAX_VALUE=r.MAX_SIGNED_VALUE,r.MIN_SIGNED_VALUE=r.fromBits(0,-2147483648,!1),r.MIN_UNSIGNED_VALUE=r.fromBits(0,0,!0),r.MIN_VALUE=r.MIN_SIGNED_VALUE,r.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},r.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*s+(this.low>>>0):this.high*s+(this.low>>>0)},r.prototype.toString=function(e){if(e=e||10,2>e||e>36)throw new Error("radix out of range: "+e);if(this.isZero())return"0";var t;if(this.isNegative()){if(this.equals(r.MIN_SIGNED_VALUE)){var n=r.fromNumber(e),i=this.div(n);return t=i.multiply(n).subtract(this),i.toString(e)+t.toInt().toString(e)}return"-"+this.negate().toString(e)}var o=r.fromNumber(Math.pow(e,6));t=this;for(var s="";;){var a=t.div(o),f=t.subtract(a.multiply(o)).toInt(),l=f.toString(e);if(t=a,t.isZero())return l+s;for(;l.length<6;)l="0"+l;s=""+l+s}},r.prototype.getHighBits=function(){return this.high},r.prototype.getHighBitsUnsigned=function(){return this.high>>>0},r.prototype.getLowBits=function(){return this.low},r.prototype.getLowBitsUnsigned=function(){return this.low>>>0},r.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(r.MIN_SIGNED_VALUE)?64:this.negate().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},r.prototype.isZero=function(){return 0==this.high&&0==this.low},r.prototype.isNegative=function(){return!this.unsigned&&this.high<0},r.prototype.isOdd=function(){return 1==(1&this.low)},r.prototype.isEven=function(){return 0==(1&this.low)},r.prototype.equals=function(e){return this.unsigned!=e.unsigned&&this.high>>>31!=e.high>>>31?!1:this.high==e.high&&this.low==e.low},r.prototype.notEquals=function(e){return!this.equals(e)},r.prototype.lessThan=function(e){return this.compare(e)<0},r.prototype.lessThanOrEqual=function(e){return this.compare(e)<=0},r.prototype.greaterThan=function(e){return this.compare(e)>0},r.prototype.greaterThanOrEqual=function(e){return this.compare(e)>=0},r.prototype.compare=function(e){if(this.equals(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high==this.high&&e.low>>>0>this.low>>>0?-1:1:this.subtract(e).isNegative()?-1:1},r.prototype.negate=function(){return!this.unsigned&&this.equals(r.MIN_SIGNED_VALUE)?r.MIN_SIGNED_VALUE:this.not().add(r.ONE)},r.prototype.add=function(e){var t=this.high>>>16,n=65535&this.high,i=this.low>>>16,o=65535&this.low,s=e.high>>>16,a=65535&e.high,f=e.low>>>16,l=65535&e.low,h=0,u=0,p=0,c=0;return c+=o+l,p+=c>>>16,c&=65535,p+=i+f,u+=p>>>16,p&=65535,u+=n+a,h+=u>>>16,u&=65535,h+=t+s,h&=65535,r.fromBits(p<<16|c,h<<16|u,this.unsigned)},r.prototype.subtract=function(e){return this.add(e.negate())},r.prototype.multiply=function(e){if(this.isZero())return r.ZERO;if(e.isZero())return r.ZERO;if(this.equals(r.MIN_VALUE))return e.isOdd()?r.MIN_VALUE:r.ZERO;if(e.equals(r.MIN_VALUE))return this.isOdd()?r.MIN_VALUE:r.ZERO;if(this.isNegative())return e.isNegative()?this.negate().multiply(e.negate()):this.negate().multiply(e).negate();if(e.isNegative())return this.multiply(e.negate()).negate();if(this.lessThan(l)&&e.lessThan(l))return r.fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,n=65535&this.high,i=this.low>>>16,o=65535&this.low,s=e.high>>>16,a=65535&e.high,f=e.low>>>16,h=65535&e.low,u=0,p=0,c=0,d=0;return d+=o*h,c+=d>>>16,d&=65535,c+=i*h,p+=c>>>16,c&=65535,c+=o*f,p+=c>>>16,c&=65535,p+=n*h,u+=p>>>16,p&=65535,p+=i*f,u+=p>>>16,p&=65535,p+=o*a,u+=p>>>16,p&=65535,u+=t*h+n*f+i*a+o*s,u&=65535,r.fromBits(c<<16|d,u<<16|p,this.unsigned)},r.prototype.div=function(e){if(e.isZero())throw new Error("division by zero");if(this.isZero())return this.unsigned?r.UZERO:r.ZERO;var t,n,i;if(this.equals(r.MIN_SIGNED_VALUE)){if(e.equals(r.ONE)||e.equals(r.NEG_ONE))return r.MIN_SIGNED_VALUE;if(e.equals(r.MIN_SIGNED_VALUE))return r.ONE;var o=this.shiftRight(1);return t=o.div(e).shiftLeft(1),t.equals(r.ZERO)?e.isNegative()?r.ONE:r.NEG_ONE:(n=this.subtract(e.multiply(t)),i=t.add(n.div(e)))}if(e.equals(r.MIN_SIGNED_VALUE))return this.unsigned?r.UZERO:r.ZERO;if(this.isNegative())return e.isNegative()?this.negate().div(e.negate()):this.negate().div(e).negate();if(e.isNegative())return this.div(e.negate()).negate();for(i=r.ZERO,n=this;n.greaterThanOrEqual(e);){t=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(t)/Math.LN2),a=48>=s?1:Math.pow(2,s-48),f=r.fromNumber(t,this.unsigned),l=f.multiply(e);l.isNegative()||l.greaterThan(n);)t-=a,f=r.fromNumber(t,this.unsigned),l=f.multiply(e);f.isZero()&&(f=r.ONE),i=i.add(f),n=n.subtract(l)}return i},r.prototype.modulo=function(e){return this.subtract(this.div(e).multiply(e))},r.prototype.not=function(){return r.fromBits(~this.low,~this.high,this.unsigned)},r.prototype.and=function(e){return r.fromBits(this.low&e.low,this.high&e.high,this.unsigned)},r.prototype.or=function(e){return r.fromBits(this.low|e.low,this.high|e.high,this.unsigned)},r.prototype.xor=function(e){return r.fromBits(this.low^e.low,this.high^e.high,this.unsigned)},r.prototype.shiftLeft=function(e){if(e&=63,0==e)return this;var t=this.low;if(32>e){var n=this.high;return r.fromBits(t<<e,n<<e|t>>>32-e,this.unsigned)}return r.fromBits(0,t<<e-32,this.unsigned)},r.prototype.shiftRight=function(e){if(e&=63,0==e)return this;var t=this.high;if(32>e){var n=this.low;return r.fromBits(n>>>e|t<<32-e,t>>e,this.unsigned)}return r.fromBits(t>>e-32,t>=0?0:-1,this.unsigned)},r.prototype.shiftRightUnsigned=function(e){if(e&=63,0==e)return this;var t=this.high;if(32>e){var n=this.low;return r.fromBits(n>>>e|t<<32-e,t>>>e,this.unsigned)}return 32==e?r.fromBits(t,0,this.unsigned):r.fromBits(t>>>e-32,0,this.unsigned)},r.prototype.toSigned=function(){var e=this.clone();return e.unsigned=!1,e},r.prototype.toUnsigned=function(){var e=this.clone();return e.unsigned=!0,e},r.prototype.clone=function(){return new r(this.low,this.high,this.unsigned)},"undefined"!=typeof t&&t.exports?t.exports=r:"undefined"!=typeof define&&define.amd?define("Math/Long",[],function(){return r}):(e.dcodeIO||(e.dcodeIO={}),e.dcodeIO.Long=r)}(this)},{}],33:[function(e,t){t.exports=e("./dist/Long.js")},{"./dist/Long.js":32}]},{},[7]);
//# sourceMappingURL=../maps/bundle.js.map